> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2731 and data parallel seed: 13
[25201] rank = 0, world_size = 4
[25203] rank = 2, world_size = 4
[25202] rank = 1, world_size = 4
[25204] rank = 3, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.1793628454208374, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 0.475671
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7372286319732666s, THROUGHPUT = 28293.339803045783 samples/s
Epoch: 2 	Training Loss: 0.699855
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6458656787872314s, THROUGHPUT = 29863.91941547625 samples/s
Epoch: 3 	Training Loss: 115.335380
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6231603622436523s, THROUGHPUT = 30281.66602840059 samples/s
Epoch: 4 	Training Loss: 565.105350
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6584038734436035s, THROUGHPUT = 29638.136274934048 samples/s
Epoch: 5 	Training Loss: 27092127.111333
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.8117525577545166s, THROUGHPUT = 27129.532556542334 samples/s
Epoch: 6 	Training Loss: 122907.249600
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6197841167449951s, THROUGHPUT = 30344.784525219584 samples/s
Epoch: 7 	Training Loss: 55687668.258133
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6480865478515625s, THROUGHPUT = 29823.67647140516 samples/s
Epoch: 8 	Training Loss: 1444724814.643200
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7331798076629639s, THROUGHPUT = 28359.43494303515 samples/s
Epoch: 9 	Training Loss: 49897942286.335999
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6221632957458496s, THROUGHPUT = 30300.27872588533 samples/s
Epoch: 10 	Training Loss: 1597773764746.717773
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6902344226837158s, THROUGHPUT = 29079.989935335463 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 16.79108428955078s, AVG. THROUGHPUT = 29311.47586792797 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 16.795745134353638s, AVG. THROUGHPUT = 29303.80788038829 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 16.803613901138306s, AVG. THROUGHPUT = 29293.115787142284 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 16.8170108795166s, AVG. THROUGHPUT = 29269.811403705786 samples/s
Test Loss: 9599436277.350401


Test Accuracy (Overall): 9.7400% (974/10000)
Test Loss: 9599436277.350401


Test Accuracy (Overall): 9.7400% (974/10000)
Test Loss: 9599436277.350401


Test Accuracy (Overall): 9.7400% (974/10000)
Test Loss: 9599436277.350401


Test Accuracy (Overall): 9.7400% (974/10000)
Best ips: 29311.47586792797, Latency: 0.5634114742279053, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2736 and data parallel seed: 18
[27976] rank = 3, world_size = 4
[27973] rank = 0, world_size = 4
[27975] rank = 2, world_size = 4
[27974] rank = 1, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.1798, best latency: 0.1798 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.1796, best latency: 0.1781 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.1827, best latency: 0.1781 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.1833, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.1830, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.1828, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.1825, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.1845, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.1924, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.1953, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.1997, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.1976, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.1974, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.1979, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.1935, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.1950, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.1983, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 170, current latency: 0.1960, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 180, current latency: 0.1985, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 190, current latency: 0.1992, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 200, current latency: 0.1928, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 210, current latency: 0.1922, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 220, current latency: 0.1991, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 230, current latency: 0.1967, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 240, current latency: 0.1960, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 250, current latency: 0.1941, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 260, current latency: 0.1934, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 270, current latency: 0.1955, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 280, current latency: 0.1987, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 290, current latency: 0.1962, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 300, current latency: 0.2371, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 310, current latency: 0.2359, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 320, current latency: 0.2317, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 330, current latency: 0.2298, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 340, current latency: 0.2300, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 350, current latency: 0.2335, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 360, current latency: 0.2292, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 370, current latency: 0.2301, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 380, current latency: 0.2333, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 390, current latency: 0.2297, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 400, current latency: 0.3100, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 410, current latency: 0.3120, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 420, current latency: 0.3088, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 430, current latency: 0.3152, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 440, current latency: 0.3127, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 450, current latency: 0.3084, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 460, current latency: 0.3054, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 470, current latency: 0.3456, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 480, current latency: 0.3467, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 490, current latency: 0.3463, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 500, current latency: 0.3804, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 510, current latency: 0.3763, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 520, current latency: 0.3777, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 530, current latency: 0.3894, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 540, current latency: 0.3906, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 550, current latency: 0.3908, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 560, current latency: 0.3912, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 570, current latency: 0.4017, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 580, current latency: 0.4061, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 590, current latency: 0.3990, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 600, current latency: 0.4008, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 610, current latency: 0.4034, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 620, current latency: 0.4036, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 630, current latency: 0.4056, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 640, current latency: 0.4000, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 650, current latency: 0.4159, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 660, current latency: 0.4171, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
iteration: 670, current latency: 0.4979, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 680, current latency: 0.5018, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
iteration: 690, current latency: 0.5025, best latency: 0.1777 baseline latency: 0.1798
iteration: 700, current latency: 0.5004, best latency: 0.1777 baseline latency: 0.1798
iteration: 710, current latency: 0.4929, best latency: 0.1777 baseline latency: 0.1798
iteration: 720, current latency: 0.4785, best latency: 0.1777 baseline latency: 0.1798
iteration: 730, current latency: 0.4812, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
iteration: 740, current latency: 0.4819, best latency: 0.1777 baseline latency: 0.1798
iteration: 750, current latency: 0.4786, best latency: 0.1777 baseline latency: 0.1798
iteration: 760, current latency: 0.4798, best latency: 0.1777 baseline latency: 0.1798
iteration: 770, current latency: 0.4841, best latency: 0.1777 baseline latency: 0.1798
iteration: 780, current latency: 0.4780, best latency: 0.1777 baseline latency: 0.1798
iteration: 790, current latency: 0.4827, best latency: 0.1777 baseline latency: 0.1798
iteration: 800, current latency: 0.4775, best latency: 0.1777 baseline latency: 0.1798
iteration: 810, current latency: 0.4835, best latency: 0.1777 baseline latency: 0.1798
iteration: 820, current latency: 0.4834, best latency: 0.1777 baseline latency: 0.1798
iteration: 830, current latency: 0.4831, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
iteration: 840, current latency: 0.4776, best latency: 0.1777 baseline latency: 0.1798
no new strategies could be found
iteration: 850, current latency: 0.4785, best latency: 0.1777 baseline latency: 0.1798
iteration: 860, current latency: 0.4789, best latency: 0.1777 baseline latency: 0.1798
iteration: 870, current latency: 0.4808, best latency: 0.1777 baseline latency: 0.1798
iteration: 880, current latency: 0.4848, best latency: 0.1777 baseline latency: 0.1798
iteration: 890, current latency: 0.4924, best latency: 0.1777 baseline latency: 0.1798
iteration: 900, current latency: 0.4917, best latency: 0.1777 baseline latency: 0.1798
iteration: 910, current latency: 0.4943, best latency: 0.1777 baseline latency: 0.1798
iteration: 920, current latency: 0.4938, best latency: 0.1777 baseline latency: 0.1798
iteration: 930, current latency: 0.4968, best latency: 0.1777 baseline latency: 0.1798
iteration: 940, current latency: 0.4909, best latency: 0.1777 baseline latency: 0.1798
iteration: 950, current latency: 0.4972, best latency: 0.1777 baseline latency: 0.1798
iteration: 960, current latency: 0.4959, best latency: 0.1777 baseline latency: 0.1798
iteration: 970, current latency: 0.4907, best latency: 0.1777 baseline latency: 0.1798
iteration: 980, current latency: 0.4922, best latency: 0.1777 baseline latency: 0.1798
iteration: 990, current latency: 0.4955, best latency: 0.1777 baseline latency: 0.1798
optimal latency: 0.17772288322448732, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 0.475227
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6454894542694092s, THROUGHPUT = 29870.74749854492 samples/s
Epoch: 2 	Training Loss: 0.934365
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6875910758972168s, THROUGHPUT = 29125.539179488773 samples/s
Epoch: 3 	Training Loss: 823.631538
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6657941341400146s, THROUGHPUT = 29506.64730571601 samples/s
Epoch: 4 	Training Loss: 2.289762
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7437469959259033s, THROUGHPUT = 28187.575442331316 samples/s
Epoch: 5 	Training Loss: 99600593.373867
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6543095111846924s, THROUGHPUT = 29711.489698684632 samples/s
Epoch: 6 	Training Loss: 64644628.582400
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.8055922985076904s, THROUGHPUT = 27222.09218582943 samples/s
Epoch: 7 	Training Loss: 145268518.980267
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7587363719940186s, THROUGHPUT = 27947.338090399808 samples/s
Epoch: 8 	Training Loss: 139813981723.306671
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6527690887451172s, THROUGHPUT = 29739.181555796877 samples/s
Epoch: 9 	Training Loss: 12140987040.836267
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6531176567077637s, THROUGHPUT = 29732.910903563738 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 17.100630283355713s, AVG. THROUGHPUT = 28774.02761892412 samples/s
Epoch: 10 	Training Loss: 264305598319.820801
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7933974266052246s, THROUGHPUT = 27407.19891242472 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 17.06194281578064s, AVG. THROUGHPUT = 28845.072077278026 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 17.09884548187256s, AVG. THROUGHPUT = 28778.873352378356 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 17.11740207672119s, AVG. THROUGHPUT = 28744.83547400323 samples/s
Test Loss: 416696239495.577576


Test Accuracy (Overall): 11.3500% (1135/10000)
Test Loss: 416696239495.577576


Test Accuracy (Overall): 11.3500% (1135/10000)
Best ips: 28845.072077278026, Latency: 0.5977991422017416, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
Test Loss: 416696239495.577576


Test Accuracy (Overall): 11.3500% (1135/10000)
Test Loss: 416696239495.577576


Test Accuracy (Overall): 11.3500% (1135/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2773 and data parallel seed: 55
[10117] rank = 2, world_size = 4
[10115] rank = 0, world_size = 4
[10116] rank = 1, world_size = 4
[10118] rank = 3, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.6126358866691589, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.474392
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0589115619659424s, THROUGHPUT = 16068.460628659148 samples/s
Epoch: 2 	Training Loss: 0.778205
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9447100162506104s, THROUGHPUT = 16691.626587592964 samples/s
Epoch: 3 	Training Loss: 35.810253
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9855289459228516s, THROUGHPUT = 16463.414319637996 samples/s
Epoch: 4 	Training Loss: 5114.062542
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.943354368209839s, THROUGHPUT = 16699.314404977496 samples/s
Epoch: 5 	Training Loss: 1154531.255467
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9274516105651855s, THROUGHPUT = 16790.02987533943 samples/s
Epoch: 6 	Training Loss: 2497805.141333
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9549129009246826s, THROUGHPUT = 16633.992827544538 samples/s
Epoch: 7 	Training Loss: 25853078.272000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9647059440612793s, THROUGHPUT = 16579.047273966018 samples/s
Epoch: 8 	Training Loss: 823745450.188800
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9356155395507812s, THROUGHPUT = 16743.33690423284 samples/s
Epoch: 9 	Training Loss: 49739897.651200
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.9427480697631836s, THROUGHPUT = 16702.754987774228 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 29.636556386947632s, AVG. THROUGHPUT = 16587.986084355733 samples/s
Epoch: 10 	Training Loss: 12537700393.506134
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.985474109649658s, THROUGHPUT = 16463.71671458505 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 29.644712209701538s, AVG. THROUGHPUT = 16583.569452430973 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 29.55166006088257s, AVG. THROUGHPUT = 16633.87486434436 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 29.544198751449585s, AVG. THROUGHPUT = 16637.76645085491 samples/s
Test Loss: 17319132882.534401


Test Accuracy (Overall): 10.1000% (1010/10000)
Test Loss: 17319132882.534401


Test Accuracy (Overall): 10.1000% (1010/10000)
Best ips: 16583.569452430973, Latency: 0.9951580365498861, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
Test Loss: 17319132882.534401


Test Accuracy (Overall): 10.1000% (1010/10000)
Test Loss: 17319132882.534401


Test Accuracy (Overall): 10.1000% (1010/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
[73814] rank = 3, world_size = 4
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2732 and data parallel seed: 14
[73812] rank = 1, world_size = 4
[73813] rank = 2, world_size = 4
[73811] rank = 0, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2733 and data parallel seed: 15
[75244] rank = 1, world_size = 4
[75246] rank = 3, world_size = 4
[75243] rank = 0, world_size = 4
[75245] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
[83790] rank = 2, world_size = 4
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2757 and data parallel seed: 39
[83788] rank = 0, world_size = 4
[83791] rank = 3, world_size = 4
[83789] rank = 1, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2760 and data parallel seed: 42
[85760] rank = 1, world_size = 4
[85759] rank = 0, world_size = 4
[85762] rank = 3, world_size = 4
[85761] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2764 and data parallel seed: 46
[88150] rank = 1, world_size = 4
[88151] rank = 2, world_size = 4
[88152] rank = 3, world_size = 4
[88149] rank = 0, world_size = 4
finding optimal strategyfinding optimal strategy

finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2768 and data parallel seed: 50
[90567] rank = 1, world_size = 4
[90568] rank = 2, world_size = 4
[90566] rank = 0, world_size = 4
[90569] rank = 3, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2772 and data parallel seed: 54
[92834] rank = 0, world_size = 4
[92837] rank = 3, world_size = 4
[92835] rank = 1, world_size = 4
[92836] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
[76128] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '49103', 'RANK': '2', 'WORLD_SIZE': '4'}
[76127] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '49103', 'RANK': '1', 'WORLD_SIZE': '4'}
[76129] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '49103', 'RANK': '3', 'WORLD_SIZE': '4'}
[76126] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '49103', 'RANK': '0', 'WORLD_SIZE': '4'}
[76126] rank = 0, world_size = 4
[76128] rank = 2, world_size = 4
[76129] rank = 3, world_size = 4
[76127] rank = 1, world_size = 4
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 16.725275993347168s, AVG. THROUGHPUT = 29635.453650049072 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 16.726019382476807s, AVG. THROUGHPUT = 29636.63715986755 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 16.737130403518677s, AVG. THROUGHPUT = 29604.30021018044 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 16.744924783706665s, AVG. THROUGHPUT = 29609.534300735868 samples/s
Test Loss: 14965566167.449600


Test Accuracy (Overall): 9.8000% (980/10000)
[76126] rank = 0, world_size = 4
Test Loss: 14965566167.449600


Test Accuracy (Overall): 9.8000% (980/10000)
[76127] rank = 1, world_size = 4
Test Loss: 14965566167.449600


Test Accuracy (Overall): 9.8000% (980/10000)
[76129] rank = 3, world_size = 4
Test Loss: 14965566167.449600


Test Accuracy (Overall): 9.8000% (980/10000)
[76128] rank = 2, world_size = 4
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 16.387498140335083s, AVG. THROUGHPUT = 30015.21687341626 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 16.409822463989258s, AVG. THROUGHPUT = 29972.00758975886 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 16.39933180809021s, AVG. THROUGHPUT = 29988.253960132562 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 16.369844675064087s, AVG. THROUGHPUT = 30054.122486543823 samples/s
Test Loss: 29485163485.593601


Test Accuracy (Overall): 9.5800% (958/10000)
Test Loss: 29485163485.593601


Test Accuracy (Overall): 9.5800% (958/10000)
Test Loss: 29485163485.593601


Test Accuracy (Overall): 9.5800% (958/10000)
Rank: 0, ips: 29972.00758975886, 
Test Loss: 29485163485.593601


Test Accuracy (Overall): 9.5800% (958/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2739 and data parallel seed: 21
[11094] rank = 2, world_size = 4
[11095] rank = 3, world_size = 4
[11093] rank = 1, world_size = 4
[11092] rank = 0, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.6289923310279846, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.475207
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.273271322250366s, THROUGHPUT = 15016.170418224945 samples/s
Epoch: 2 	Training Loss: 0.900385
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.129878520965576s, THROUGHPUT = 15704.123872781003 samples/s
Epoch: 3 	Training Loss: 11.997568
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.205462694168091s, THROUGHPUT = 15333.82375325268 samples/s
Epoch: 4 	Training Loss: 510.282306
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.089766025543213s, THROUGHPUT = 15908.00066854854 samples/s
Epoch: 5 	Training Loss: 15893.551467
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.220238208770752s, THROUGHPUT = 15263.467114366855 samples/s
Epoch: 6 	Training Loss: 282827.396279
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1400980949401855s, THROUGHPUT = 15653.014177869585 samples/s
Epoch: 7 	Training Loss: 154150.582933
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.095564842224121s, THROUGHPUT = 15878.200750169057 samples/s
Epoch: 8 	Training Loss: 9343003.613867
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1109988689422607s, THROUGHPUT = 15799.427152061831 samples/s
Epoch: 9 	Training Loss: 108723206.041600
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.121730089187622s, THROUGHPUT = 15745.115239220117 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 31.468154907226562s, AVG. THROUGHPUT = 15625.525033514034 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 31.46856164932251s, AVG. THROUGHPUT = 15625.400421371936 samples/s
Epoch: 10 	Training Loss: 476717243.323733
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0808897018432617s, THROUGHPUT = 15953.833066660229 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 31.469268560409546s, AVG. THROUGHPUT = 15625.517621315486 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 31.46832036972046s, AVG. THROUGHPUT = 15625.556781116416 samples/s
Test Loss: 1132239142.707200


Test Accuracy (Overall): 9.8000% (980/10000)
Test Loss: 1132239142.707200


Test Accuracy (Overall): 9.8000% (980/10000)
Test Loss: 1132239142.707200


Test Accuracy (Overall): 9.8000% (980/10000)
Test Loss: 1132239142.707200


Test Accuracy (Overall): 9.8000% (980/10000)
Best ips: 15625.517621315486, Latency: 1.026963233947754, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
[24549] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '52627', 'RANK': '3', 'WORLD_SIZE': '4'}
[24548] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '52627', 'RANK': '2', 'WORLD_SIZE': '4'}
[24547] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '52627', 'RANK': '1', 'WORLD_SIZE': '4'}
[24546] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '52627', 'RANK': '0', 'WORLD_SIZE': '4'}
[24546] rank = 0, world_size = 4
[24547] rank = 1, world_size = 4
[24549] rank = 3, world_size = 4
[24548] rank = 2, world_size = 4
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 2913290
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 18.2395076751709s, AVG. THROUGHPUT = 27029.48922175823 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 18.241517782211304s, AVG. THROUGHPUT = 27017.34515137373 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 18.244292736053467s, AVG. THROUGHPUT = 27023.398917338385 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 18.248788833618164s, AVG. THROUGHPUT = 27010.683414650055 samples/s
Test Loss: 0.320246


Test Accuracy (Overall): 90.9800% (9098/10000)
[24546] rank = 0, world_size = 4
Test Loss: 0.320246


Test Accuracy (Overall): 90.9800% (9098/10000)
[24547] rank = 1, world_size = 4
Test Loss: 0.320246


Test Accuracy (Overall): 90.9800% (9098/10000)
[24548] rank = 2, world_size = 4
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 2913290
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
Test Loss: 0.320246


Test Accuracy (Overall): 90.9800% (9098/10000)
[24549] rank = 3, world_size = 4
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 17.479257345199585s, AVG. THROUGHPUT = 28148.644010840886 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 17.458125829696655s, AVG. THROUGHPUT = 28177.745244473248 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 17.41830801963806s, AVG. THROUGHPUT = 28240.022354747092 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 17.541565656661987s, AVG. THROUGHPUT = 28058.007033233174 samples/s
Test Loss: 0.299130


Test Accuracy (Overall): 91.4100% (9141/10000)
Rank: 0, ips: 28058.007033233174, 
Test Loss: 0.299130


Test Accuracy (Overall): 91.4100% (9141/10000)
Test Loss: 0.299130


Test Accuracy (Overall): 91.4100% (9141/10000)
Test Loss: 0.299130


Test Accuracy (Overall): 91.4100% (9141/10000)
[26767] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '58383', 'RANK': '3', 'WORLD_SIZE': '4'}
[26765] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '58383', 'RANK': '1', 'WORLD_SIZE': '4'}
[26764] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '58383', 'RANK': '0', 'WORLD_SIZE': '4'}
[26766] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.dudu-jax.pelegdav.svc.cluster.local', 'MASTER_PORT': '58383', 'RANK': '2', 'WORLD_SIZE': '4'}
[26764] rank = 0, world_size = 4
[26765] rank = 1, world_size = 4
[26766] rank = 2, world_size = 4
[26767] rank = 3, world_size = 4
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 20.98418164253235s, AVG. THROUGHPUT = 23452.36720417273 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 20.99401068687439s, AVG. THROUGHPUT = 23439.388136896032 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 20.994322776794434s, AVG. THROUGHPUT = 23436.94380015716 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 20.995375156402588s, AVG. THROUGHPUT = 23437.496785685496 samples/s
Test Loss: 4673050629.734400


Test Accuracy (Overall): 10.0900% (1009/10000)
[26765] rank = 1, world_size = 4
Test Loss: 4673050629.734400


Test Accuracy (Overall): 10.0900% (1009/10000)
[26767] rank = 3, world_size = 4
Test Loss: 4673050629.734400


Test Accuracy (Overall): 10.0900% (1009/10000)
[26764] rank = 0, world_size = 4
Test Loss: 4673050629.734400


Test Accuracy (Overall): 10.0900% (1009/10000)
[26766] rank = 2, world_size = 4
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 20.404018878936768s, AVG. THROUGHPUT = 24111.394373502233 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 20.40881657600403s, AVG. THROUGHPUT = 24103.967395656167 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 20.414496660232544s, AVG. THROUGHPUT = 24096.61938023435 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 20.423217296600342s, AVG. THROUGHPUT = 24085.08361483507 samples/s
Test Loss: 2211853693.747200


Test Accuracy (Overall): 10.1000% (1010/10000)
Rank: 0, ips: 24085.08361483507, 
Test Loss: 2211853693.747200


Test Accuracy (Overall): 10.1000% (1010/10000)
Test Loss: 2211853693.747200


Test Accuracy (Overall): 10.1000% (1010/10000)
Test Loss: 2211853693.747200


Test Accuracy (Overall): 10.1000% (1010/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2721 and data parallel seed: 3
[29828] rank = 0, world_size = 4
[29829] rank = 1, world_size = 4
[29831] rank = 3, world_size = 4
[29830] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.630988872051239, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.475278
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.2247509956359863s, THROUGHPUT = 15242.107085637546 samples/s
Epoch: 2 	Training Loss: 3.433322
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0837645530700684s, THROUGHPUT = 15938.960045139083 samples/s
Epoch: 3 	Training Loss: 3.164705
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.154777765274048s, THROUGHPUT = 15580.178274690701 samples/s
Epoch: 4 	Training Loss: 421.544295
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.132037401199341s, THROUGHPUT = 15693.299186394896 samples/s
Epoch: 5 	Training Loss: 13240.072340
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.121906280517578s, THROUGHPUT = 15744.226630612093 samples/s
Epoch: 6 	Training Loss: 309332.970333
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1053991317749023s, THROUGHPUT = 15827.91709351287 samples/s
Epoch: 7 	Training Loss: 138354.622133
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0760929584503174s, THROUGHPUT = 15978.710872496496 samples/s
Epoch: 8 	Training Loss: 6116099.584000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0988385677337646s, THROUGHPUT = 15861.426442728743 samples/s
Epoch: 9 	Training Loss: 380932775.389867
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1388802528381348s, THROUGHPUT = 15659.087330763065 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 31.314589023590088s, AVG. THROUGHPUT = 15699.427605017127 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 31.263156175613403s, AVG. THROUGHPUT = 15724.255589082735 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 31.295376777648926s, AVG. THROUGHPUT = 15708.112952497011 samples/s
Epoch: 10 	Training Loss: 4260812947.456000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1745991706848145s, THROUGHPUT = 15482.899527563692 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 31.31233549118042s, AVG. THROUGHPUT = 15700.881248953916 samples/s
Test Loss: 4636510101.504000


Test Accuracy (Overall): 10.0900% (1009/10000)
Test Loss: 4636510101.504000


Test Accuracy (Overall): 10.0900% (1009/10000)
Best ips: 15700.881248953916, Latency: 1.0581997235616047, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
Test Loss: 4636510101.504000


Test Accuracy (Overall): 10.0900% (1009/10000)
Test Loss: 4636510101.504000


Test Accuracy (Overall): 10.0900% (1009/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2729 and data parallel seed: 11
[33360] rank = 3, world_size = 4
[33359] rank = 2, world_size = 4
[33358] rank = 1, world_size = 4
[33357] rank = 0, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.22776414155960084, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.475782
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.2821974754333496s, THROUGHPUT = 21537.13713606965 samples/s
Epoch: 2 	Training Loss: 0.538022
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.0331923961639404s, THROUGHPUT = 24174.79039009586 samples/s
Epoch: 3 	Training Loss: 4.601757
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.1276509761810303s, THROUGHPUT = 23101.53335779915 samples/s
Epoch: 4 	Training Loss: 66.673716
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.150400161743164s, THROUGHPUT = 22857.141137934184 samples/s
Epoch: 5 	Training Loss: 5169.875037
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.1775145530700684s, THROUGHPUT = 22572.524225246078 samples/s
Epoch: 6 	Training Loss: 77335.003200
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.3201098442077637s, THROUGHPUT = 21185.20384830473 samples/s
Epoch: 7 	Training Loss: 952602.202333
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.1803348064422607s, THROUGHPUT = 22543.32676558206 samples/s
Epoch: 8 	Training Loss: 1700298.154667
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.1171374320983887s, THROUGHPUT = 23216.25382216367 samples/s
Epoch: 9 	Training Loss: 2304448326.860800
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.11087965965271s, THROUGHPUT = 23285.0791731475 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 21.81385612487793s, AVG. THROUGHPUT = 22571.372777496705 samples/s
Epoch: 10 	Training Loss: 10404585.335467
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 2.315701723098755s, THROUGHPUT = 21225.53155689986 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 21.8162362575531s, AVG. THROUGHPUT = 22569.852141324278 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 21.810977458953857s, AVG. THROUGHPUT = 22574.927547350602 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 21.806535482406616s, AVG. THROUGHPUT = 22579.339820296787 samples/s
Test Loss: 223405444.582400


Test Accuracy (Overall): 9.8000% (980/10000)
Test Loss: 223405444.582400


Test Accuracy (Overall): 9.8000% (980/10000)
Test Loss: 223405444.582400


Test Accuracy (Overall): 9.8000% (980/10000)
Best ips: 22569.852141324278, Latency: 0.7719005743662516, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
Test Loss: 223405444.582400


Test Accuracy (Overall): 9.8000% (980/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2732 and data parallel seed: 14
[35666] rank = 0, world_size = 4
[35668] rank = 2, world_size = 4
[35669] rank = 3, world_size = 4
[35667] rank = 1, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
[37755] rank = 3, world_size = 4
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2736 and data parallel seed: 18
[37752] rank = 0, world_size = 4[37753] rank = 1, world_size = 4

[37754] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 1.0668546319007874, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.475043
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.746457099914551s, THROUGHPUT = 10355.513378786225 samples/s
Epoch: 2 	Training Loss: 0.920097
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.677932262420654s, THROUGHPUT = 10507.206441370248 samples/s
Epoch: 3 	Training Loss: 8.974916
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.658139705657959s, THROUGHPUT = 10551.85183482111 samples/s
Epoch: 4 	Training Loss: 172.279089
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.601494550704956s, THROUGHPUT = 10681.746866889114 samples/s
Epoch: 5 	Training Loss: 10272.113251
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.577483654022217s, THROUGHPUT = 10737.777284427948 samples/s
Epoch: 6 	Training Loss: 2875243.722667
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.813602685928345s, THROUGHPUT = 10211.062941211696 samples/s
Epoch: 7 	Training Loss: 48485.563200
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.608615398406982s, THROUGHPUT = 10665.242323538198 samples/s
Epoch: 8 	Training Loss: 958415.236267
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.647493124008179s, THROUGHPUT = 10576.024254041156 samples/s
Epoch: 9 	Training Loss: 4182045315.891200
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.5988147258758545s, THROUGHPUT = 10687.971342580862 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 46.519803285598755s, AVG. THROUGHPUT = 10567.672995946668 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 46.649495363235474s, AVG. THROUGHPUT = 10538.882562485262 samples/s
Epoch: 10 	Training Loss: 23640831339.178665
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 4.71232795715332s, THROUGHPUT = 10430.5134207366 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 46.64395785331726s, AVG. THROUGHPUT = 10540.491008840316 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 46.6162314414978s, AVG. THROUGHPUT = 10545.98356458747 samples/s
Test Loss: 287957783937.023987


Test Accuracy (Overall): 9.5800% (958/10000)
Test Loss: 287957783937.023987


Test Accuracy (Overall): 9.5800% (958/10000)
Test Loss: 287957783937.023987


Test Accuracy (Overall): 9.5800% (958/10000)
Test Loss: 287957783937.023987


Test Accuracy (Overall): 9.5800% (958/10000)
Best ips: 10540.491008840316, Latency: 1.5707759857177734, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": true,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2760 and data parallel seed: 42
[46367] rank = 3, world_size = 4
[46364] rank = 0, world_size = 4
[46365] rank = 1, world_size = 4[46366] rank = 2, world_size = 4

finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.6308635950088501, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.475240
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1584973335266113s, THROUGHPUT = 15561.830455978088 samples/s
Epoch: 2 	Training Loss: 0.771384
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.172895908355713s, THROUGHPUT = 15491.211000827316 samples/s
Epoch: 3 	Training Loss: 232.893926
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.092470645904541s, THROUGHPUT = 15894.087811340614 samples/s
Epoch: 4 	Training Loss: 50.324913
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0743935108184814s, THROUGHPUT = 15987.543503145924 samples/s
Epoch: 5 	Training Loss: 167368.049902
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1532716751098633s, THROUGHPUT = 15587.619800722528 samples/s
Epoch: 6 	Training Loss: 1093668.010667
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0787835121154785s, THROUGHPUT = 15964.747052392431 samples/s
Epoch: 7 	Training Loss: 8835807.573333
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.114078998565674s, THROUGHPUT = 15783.799968671032 samples/s
Epoch: 8 	Training Loss: 521412597.077333
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.0961270332336426s, THROUGHPUT = 15875.317605642587 samples/s
Epoch: 9 	Training Loss: 3324677169.698133
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.130714178085327s, THROUGHPUT = 15699.93209346892 samples/s
Epoch: 10 	Training Loss: 177140209656.354126
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 3.1452841758728027s, THROUGHPUT = 15627.20480935893 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 31.218212366104126s, AVG. THROUGHPUT = 15747.329410154834 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 31.17217779159546s, AVG. THROUGHPUT = 15769.381919481952 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 31.214317560195923s, AVG. THROUGHPUT = 15748.862354616005 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 31.216153144836426s, AVG. THROUGHPUT = 15747.665619902673 samples/s
Test Loss: 412505005.721600


Test Accuracy (Overall): 10.2100% (1021/10000)
Test Loss: 412505005.721600


Test Accuracy (Overall): 10.2100% (1021/10000)
Best ips: 15747.329410154834, Latency: 1.0484280586242676, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
Test Loss: 412505005.721600


Test Accuracy (Overall): 10.2100% (1021/10000)
Test Loss: 412505005.721600


Test Accuracy (Overall): 10.2100% (1021/10000)
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2752 and data parallel seed: 34
[35623] rank = 0, world_size = 4
[35625] rank = 2, world_size = 4
[35626] rank = 3, world_size = 4
[35624] rank = 1, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.17451648712158202, optimal strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}}
Epoch: 1 	Training Loss: 0.474127
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7734158039093018s, THROUGHPUT = 27716.00427358873 samples/s
Epoch: 2 	Training Loss: 1.222050
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6878821849822998s, THROUGHPUT = 29120.51589697621 samples/s
Epoch: 3 	Training Loss: 2.064416
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7026307582855225s, THROUGHPUT = 28868.267391982274 samples/s
Epoch: 4 	Training Loss: 60.337586
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.6946287155151367s, THROUGHPUT = 29004.5834524046 samples/s
Epoch: 5 	Training Loss: 31433.523875
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7881968021392822s, THROUGHPUT = 27486.907448440656 samples/s
Epoch: 6 	Training Loss: 89601.318954
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.697934627532959s, THROUGHPUT = 28948.110959616966 samples/s
Epoch: 7 	Training Loss: 787697.063067
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7065892219543457s, THROUGHPUT = 28801.306938826376 samples/s
Epoch: 8 	Training Loss: 395655339.912533
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7878189086914062s, THROUGHPUT = 27492.717389356174 samples/s
Epoch: 9 	Training Loss: 2439420.211200
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.7706713676452637s, THROUGHPUT = 27758.96244674981 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 17.28062129020691s, AVG. THROUGHPUT = 28459.421685436748 samples/s
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 17.275779008865356s, AVG. THROUGHPUT = 28466.801459189388 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 17.397099494934082s, AVG. THROUGHPUT = 28282.83671061451 samples/s
Epoch: 10 	Training Loss: 247712700.689067
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 1.690908670425415s, THROUGHPUT = 29068.394325303132 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 17.301986932754517s, AVG. THROUGHPUT = 28426.577052324494 samples/s
Test Loss: 8432343922088.345703


Test Accuracy (Overall): 10.1000% (1010/10000)
Test Loss: 8432343922088.345703

Test Loss: 8432343922088.345703


Test Accuracy (Overall): 10.1000% (1010/10000)

Test Accuracy (Overall): 10.1000% (1010/10000)
Best ips: 28426.577052324494, Latency: 0.5636362234751383, Best strategy:
{'seq.0': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.1': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.2': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.3': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.4': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.5': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.6': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.7': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.8': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.9': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.10': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.11': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.12': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.13': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.14': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.15': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.16': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.17': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.18': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.19': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.20': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.21': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.22': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.23': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.24': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.25': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.26': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.27': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.28': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.29': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.30': {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}, 'seq.31': {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}} 
Test Loss: 8432343922088.345703


Test Accuracy (Overall): 10.1000% (1010/10000)
