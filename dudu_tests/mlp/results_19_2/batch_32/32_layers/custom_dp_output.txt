> initializing model parallel with size 1
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2737 and data parallel seed: 19
[49] rank = 0, world_size = 1
finding optimal strategy
optimal latency: 0.009930801391601563, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 77723306401464729600.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 87.9631941318512s, THROUGHPUT = 682.103470572747 samples/s
Epoch: 2 	Training Loss: 31424214918534844.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 87.76428151130676s, THROUGHPUT = 683.6494182689815 samples/s
Epoch: 3 	Training Loss: 10345934875655982.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 88.71262168884277s, THROUGHPUT = 676.3411886354621 samples/s
Epoch: 4 	Training Loss: 4050031723996372.500000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 89.55851316452026s, THROUGHPUT = 669.9530606295255 samples/s
> initializing model parallel with size 1
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2743 and data parallel seed: 25
[352] rank = 0, world_size = 1
finding optimal strategy
optimal latency: 0.010381412506103516, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 173281113070971551744.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 87.244633436203s, THROUGHPUT = 687.7213833888655 samples/s
Epoch: 2 	Training Loss: 10972077946912218.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 86.79222297668457s, THROUGHPUT = 691.3061786206133 samples/s
Epoch: 3 	Training Loss: 3430520191229956.500000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 86.98303842544556s, THROUGHPUT = 689.7896542373245 samples/s
Epoch: 4 	Training Loss: 1396550647041211.250000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 86.89165496826172s, THROUGHPUT = 690.5151020764395 samples/s
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 347.91240644454956s, BATCH = 32 AVG. THROUGHPUT = 689.8330795808108 samples/s, AVG. LATENCY = 86.97788745164871
Test Loss: 9121891288822.580078


Test Accuracy (Overall): 9.6000% (960/10000)
Best ips: 689.8330795808108, Latency: 0.046342215983072914, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 2
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2756 and data parallel seed: 38
[5064] rank = 0, world_size = 2
[5065] rank = 1, world_size = 2
finding optimal strategy
finding optimal strategy
optimal latency: 0.017100703716278077, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 145757543712078331904.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 54.90019392967224s, THROUGHPUT = 1092.3094384114504 samples/s
Epoch: 2 	Training Loss: 20811954980191452.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 54.940471172332764s, THROUGHPUT = 1091.5086587426106 samples/s
Epoch: 3 	Training Loss: 7323118734038952.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 54.95608735084534s, THROUGHPUT = 1091.198498487676 samples/s
Epoch: 4 	Training Loss: 3678082119951083.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 55.39898133277893s, THROUGHPUT = 1082.4747776457332 samples/s
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 220.19660663604736s, BATCH = 32 AVG. THROUGHPUT = 1089.3728433218675 samples/s, AVG. LATENCY = 55.04893344640732
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 220.20706987380981s, BATCH = 32 AVG. THROUGHPUT = 1089.3197004206118 samples/s, AVG. LATENCY = 55.051675736904144
Test Loss: 180255378507615.437500


Test Accuracy (Overall): 16.6200% (1662/10000)
Test Loss: 180255378507615.437500


Test Accuracy (Overall): 16.6200% (1662/10000)
Best ips: 1089.3728433218675, Latency: 0.05912377943733077, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 3
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2757 and data parallel seed: 39
[6655] rank = 1, world_size = 3
[6654] rank = 0, world_size = 3
[6656] rank = 2, world_size = 3
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.02147289514541626, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 67374807101767606272.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 41.52044057846069s, THROUGHPUT = 1445.071371210975 samples/s
Epoch: 2 	Training Loss: 27958888416526852.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 41.14472508430481s, THROUGHPUT = 1458.267126030398 samples/s
Epoch: 3 	Training Loss: 11043012616310314.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 40.12166738510132s, THROUGHPUT = 1495.4513087429725 samples/s
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 162.83326959609985s, BATCH = 32 AVG. THROUGHPUT = 1474.272254285977 samples/s, AVG. LATENCY = 40.70818704366684
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 162.8423228263855s, BATCH = 32 AVG. THROUGHPUT = 1474.1875072548005 samples/s, AVG. LATENCY = 40.710464000701904
Epoch: 4 	Training Loss: 6172407261261499.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 40.05052876472473s, THROUGHPUT = 1498.107561886827 samples/s
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 162.83822631835938s, BATCH = 32 AVG. THROUGHPUT = 1474.2243419677932 samples/s, AVG. LATENCY = 40.70934045314789
Test Loss: 1878980055779822.750000
Test Loss: 1878980055779822.750000



Test Accuracy (Overall): 17.0000% (1700/10000)

Test Accuracy (Overall): 17.0000% (1700/10000)
Test Loss: 1878980055779822.750000


Test Accuracy (Overall): 17.0000% (1700/10000)
Best ips: 1474.2243419677932, Latency: 0.06408084602355957, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2777 and data parallel seed: 59
[8936] rank = 3, world_size = 4
[8934] rank = 1, world_size = 4
[8933] rank = 0, world_size = 4
[8935] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.022178256511688234, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 83530785594821607424.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.71038508415222s, THROUGHPUT = 1950.610512888451 samples/s
Epoch: 2 	Training Loss: 54629513219240448.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.634204626083374s, THROUGHPUT = 1955.4612476863517 samples/s
Epoch: 3 	Training Loss: 24154397533516124.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.451534032821655s, THROUGHPUT = 1967.191535750991 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 122.60507345199585s, BATCH = 32 AVG. THROUGHPUT = 1954.4170243499339 samples/s, AVG. LATENCY = 30.651154279708862
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 122.61364340782166s, BATCH = 32 AVG. THROUGHPUT = 1954.2792250042553 samples/s, AVG. LATENCY = 30.653301894664764
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 122.61342477798462s, BATCH = 32 AVG. THROUGHPUT = 1954.283734488719 samples/s, AVG. LATENCY = 30.653249204158783
Epoch: 4 	Training Loss: 14570939353284232.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.81738305091858s, THROUGHPUT = 1943.8379923766574 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 122.6141607761383s, BATCH = 32 AVG. THROUGHPUT = 1954.275322175613 samples/s, AVG. LATENCY = 30.653376698493958
Test Loss: 6460398851261779.000000

Test Loss: 6460398851261779.000000

Test Loss: 6460398851261779.000000


Test Accuracy (Overall): 12.9600% (1296/10000)
Test Accuracy (Overall): 12.9600% (1296/10000)

Test Loss: 6460398851261779.000000


Test Accuracy (Overall): 12.9600% (1296/10000)

Test Accuracy (Overall): 12.9600% (1296/10000)
Best ips: 1954.275322175613, Latency: 0.06584910908315936, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
> initializing model parallel with size 1
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2777 and data parallel seed: 59
[56945] rank = 0, world_size = 1
finding optimal strategy
optimal latency: 0.007427322864532471, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
> initializing model parallel with size 1
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2723 and data parallel seed: 5
[57284] rank = 0, world_size = 1
finding optimal strategy
optimal latency: 0.007034289836883545, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 67040061638263586816.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 75.3457384109497s, THROUGHPUT = 796.3290461465625 samples/s
Epoch: 2 	Training Loss: 24358440496194004.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 74.39508771896362s, THROUGHPUT = 806.5048626148168 samples/s
Epoch: 3 	Training Loss: 7542173660613915.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 74.09386038780212s, THROUGHPUT = 809.783694437895 samples/s
Epoch: 4 	Training Loss: 2971121334884919.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 74.0386004447937s, THROUGHPUT = 810.3880899901468 samples/s
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 297.8742334842682s, BATCH = 32 AVG. THROUGHPUT = 805.7514232973554 samples/s, AVG. LATENCY = 74.46832174062729
Test Loss: 22004275706068.992188


Test Accuracy (Overall): 8.6200% (862/10000)
Best ips: 805.7514232973554, Latency: 0.039487253570556644, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 5
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2743 and data parallel seed: 25
[13334] rank = 1, world_size = 5
[13333] rank = 0, world_size = 5
[13337] rank = 4, world_size = 5
[13336] rank = 3, world_size = 5
[13335] rank = 2, world_size = 5
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03159135580062866, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 72132944575698116608.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.580674409866333s, THROUGHPUT = 2099.320650715205 samples/s
Epoch: 2 	Training Loss: 45693465492236624.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.651503086090088s, THROUGHPUT = 2094.1309717579593 samples/s
Epoch: 3 	Training Loss: 22334216060195884.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.836827039718628s, THROUGHPUT = 2080.672742440024 samples/s
Epoch: 4 	Training Loss: 14084208272036156.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.49593448638916s, THROUGHPUT = 2105.563515688825 samples/s
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 114.56566572189331s, BATCH = 32 AVG. THROUGHPUT = 2094.9219701505035 samples/s, AVG. LATENCY = 28.641234755516052
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 114.68335151672363s, BATCH = 32 AVG. THROUGHPUT = 2092.7697492768693 samples/s, AVG. LATENCY = 28.67071670293808
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 114.69374895095825s, BATCH = 32 AVG. THROUGHPUT = 2092.574683126603 samples/s, AVG. LATENCY = 28.673308193683624
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 114.57299327850342s, BATCH = 32 AVG. THROUGHPUT = 2094.7877341509206 samples/s, AVG. LATENCY = 28.643101572990417
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 114.69182419776917s, BATCH = 32 AVG. THROUGHPUT = 2092.6059374274805 samples/s, AVG. LATENCY = 28.67282611131668
Test Loss: 7550225680831611.000000

Test Loss: 7550225680831611.000000
Test Loss: 7550225680831611.000000


Test Loss: 7550225680831611.000000


Test Accuracy (Overall): 11.2100% (1121/10000)
Test Accuracy (Overall): 11.2100% (1121/10000)
Test Accuracy (Overall): 11.2100% (1121/10000)



Test Accuracy (Overall): 11.2100% (1121/10000)
Test Loss: 7550225680831611.000000


Test Accuracy (Overall): 11.2100% (1121/10000)
Best ips: 2094.9219701505035, Latency: 0.07598915863037109, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 6
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2760 and data parallel seed: 42
[17103] rank = 3, world_size = 6
[17105] rank = 5, world_size = 6
[17102] rank = 2, world_size = 6
[17104] rank = 4, world_size = 6
[17100] rank = 0, world_size = 6
[17101] rank = 1, world_size = 6
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03258547782897949, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 81155031939634757632.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.427120685577393s, THROUGHPUT = 2452.356164734936 samples/s
Epoch: 2 	Training Loss: 72272132441820016.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 25.017937421798706s, THROUGHPUT = 2394.4419953582687 samples/s
Epoch: 3 	Training Loss: 28806348233543028.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.64375352859497s, THROUGHPUT = 2430.798536046523 samples/s
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 98.44557499885559s, BATCH = 32 AVG. THROUGHPUT = 2434.2857511794873 samples/s, AVG. LATENCY = 24.611281991004944
Epoch: 4 	Training Loss: 16569492552428814.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.333736658096313s, THROUGHPUT = 2461.7674154071506 samples/s
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 98.42326092720032s, BATCH = 32 AVG. THROUGHPUT = 2434.8410278867195 samples/s, AVG. LATENCY = 24.605637073516846
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 98.43562865257263s, BATCH = 32 AVG. THROUGHPUT = 2434.5208717808046 samples/s, AVG. LATENCY = 24.608808398246765
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 98.44535851478577s, BATCH = 32 AVG. THROUGHPUT = 2434.271511079656 samples/s, AVG. LATENCY = 24.611228466033936
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 98.44531893730164s, BATCH = 32 AVG. THROUGHPUT = 2434.2771137288896 samples/s, AVG. LATENCY = 24.611231803894043
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 98.47125172615051s, BATCH = 32 AVG. THROUGHPUT = 2433.6191705096676 samples/s, AVG. LATENCY = 24.617696404457092
Test Loss: 8827495594847319.000000

Test Loss: 8827495594847319.000000

Test Loss: 8827495594847319.000000
Test Loss: 8827495594847319.000000


Test Loss: 8827495594847319.000000


Test Accuracy (Overall): 13.8300% (1383/10000)
Test Accuracy (Overall): 13.8300% (1383/10000)


Test Accuracy (Overall): 13.8300% (1383/10000)

Test Accuracy (Overall): 13.8300% (1383/10000)
Test Accuracy (Overall): 13.8300% (1383/10000)

Test Loss: 8827495594847319.000000


Test Accuracy (Overall): 13.8300% (1383/10000)
Best ips: 2434.8410278867195, Latency: 0.07799274569902664, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 7
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2719 and data parallel seed: 1
[21611] rank = 0, world_size = 7
[21616] rank = 5, world_size = 7
[21613] rank = 2, world_size = 7
[21614] rank = 3, world_size = 7
[21612] rank = 1, world_size = 7
[21615] rank = 4, world_size = 7
[21617] rank = 6, world_size = 7
finding optimal strategy
finding optimal strategyfinding optimal strategy

finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03401076793670654, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 27535971881730695168.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.90936589241028s, THROUGHPUT = 2729.791464239426 samples/s
Epoch: 2 	Training Loss: 19612845912106836.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.431368350982666s, THROUGHPUT = 2790.6757525007824 samples/s
Epoch: 3 	Training Loss: 8542624994658615.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.310757637023926s, THROUGHPUT = 2806.4699068274076 samples/s
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 85.98019480705261s, BATCH = 32 AVG. THROUGHPUT = 2782.78053781481 samples/s, AVG. LATENCY = 21.494931995868683
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 85.97578501701355s, BATCH = 32 AVG. THROUGHPUT = 2782.921860180868 samples/s, AVG. LATENCY = 21.49381774663925
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 85.99059820175171s, BATCH = 32 AVG. THROUGHPUT = 2782.4655211126856 samples/s, AVG. LATENCY = 21.49748581647873
Epoch: 4 	Training Loss: 4885069623785737.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.334671020507812s, THROUGHPUT = 2803.3242201161647 samples/s
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 85.98693251609802s, BATCH = 32 AVG. THROUGHPUT = 2782.565335920945 samples/s, AVG. LATENCY = 21.49654072523117
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 85.98959851264954s, BATCH = 32 AVG. THROUGHPUT = 2782.4847954344687 samples/s, AVG. LATENCY = 21.497269809246063
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 85.9968032836914s, BATCH = 32 AVG. THROUGHPUT = 2782.249941622137 samples/s, AVG. LATENCY = 21.499104917049408
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 85.98681306838989s, BATCH = 32 AVG. THROUGHPUT = 2782.562852712797 samples/s, AVG. LATENCY = 21.496585249900818
Test Loss: 4762416732173867.000000
Test Loss: 4762416732173867.000000
Test Loss: 4762416732173867.000000



Test Loss: 4762416732173867.000000

Test Loss: 4762416732173867.000000

Test Loss: 4762416732173867.000000


Test Accuracy (Overall): 16.1500% (1615/10000)

Test Accuracy (Overall): 16.1500% (1615/10000)
Test Accuracy (Overall): 16.1500% (1615/10000)
Test Accuracy (Overall): 16.1500% (1615/10000)


Test Loss: 4762416732173867.000000


Test Accuracy (Overall): 16.1500% (1615/10000)

Test Accuracy (Overall): 16.1500% (1615/10000)

Test Accuracy (Overall): 16.1500% (1615/10000)
Best ips: 2782.565335920945, Latency: 0.07990513490826896, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 2
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2722 and data parallel seed: 4
[58432] rank = 0, world_size = 2
[58433] rank = 1, world_size = 2
finding optimal strategy
finding optimal strategy
optimal latency: 0.016613101959228514, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 64746776238909390848.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 49.121289014816284s, THROUGHPUT = 1220.8148687204048 samples/s
Epoch: 2 	Training Loss: 34288564547664584.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 48.982699394226074s, THROUGHPUT = 1224.2689917385164 samples/s
Epoch: 3 	Training Loss: 11906376802020780.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 48.918363094329834s, THROUGHPUT = 1225.8791220050234 samples/s
Epoch: 4 	Training Loss: 5872551551100815.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 49.02443337440491s, THROUGHPUT = 1223.226784530438 samples/s
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 196.0476746559143s, BATCH = 32 AVG. THROUGHPUT = 1223.5474417485957 samples/s, AVG. LATENCY = 49.011696219444275
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 196.06947445869446s, BATCH = 32 AVG. THROUGHPUT = 1223.4092983729006 samples/s, AVG. LATENCY = 49.0172581076622
Test Loss: 1116694925525018.250000

Test Loss: 1116694925525018.250000


Test Accuracy (Overall): 23.6300% (2363/10000)

Test Accuracy (Overall): 23.6300% (2363/10000)
Best ips: 1223.5474417485957, Latency: 0.052320633270442805, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 8
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2742 and data parallel seed: 24
[26871] rank = 5, world_size = 8
[26872] rank = 6, world_size = 8
[26869] rank = 3, world_size = 8[26866] rank = 0, world_size = 8

[26868] rank = 2, world_size = 8
[26873] rank = 7, world_size = 8
[26867] rank = 1, world_size = 8
[26870] rank = 4, world_size = 8
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03358018398284912, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 144501234228127776768.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 18.84211015701294s, THROUGHPUT = 3179.2617440835857 samples/s
Epoch: 2 	Training Loss: 58654098923659288.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 18.729750394821167s, THROUGHPUT = 3198.3341335164637 samples/s
Epoch: 3 	Training Loss: 28790317285290576.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 19.017126321792603s, THROUGHPUT = 3150.002738918195 samples/s
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 75.25622987747192s, BATCH = 32 AVG. THROUGHPUT = 3184.1802026955966 samples/s, AVG. LATENCY = 18.813947916030884
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 75.25087976455688s, BATCH = 32 AVG. THROUGHPUT = 3184.3980474819746 samples/s, AVG. LATENCY = 18.81259149312973
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 75.2592043876648s, BATCH = 32 AVG. THROUGHPUT = 3184.048753614392 samples/s, AVG. LATENCY = 18.81465572118759
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 75.17679286003113s, BATCH = 32 AVG. THROUGHPUT = 3187.542735472361 samples/s, AVG. LATENCY = 18.794067084789276
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 75.26424765586853s, BATCH = 32 AVG. THROUGHPUT = 3183.838730636076 samples/s, AVG. LATENCY = 18.815954446792603
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 75.25117468833923s, BATCH = 32 AVG. THROUGHPUT = 3184.377722957618 samples/s, AVG. LATENCY = 18.812692642211914
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 75.2472825050354s, BATCH = 32 AVG. THROUGHPUT = 3184.5492177933065 samples/s, AVG. LATENCY = 18.81170755624771
Epoch: 4 	Training Loss: 19137613523462040.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 18.670387029647827s, THROUGHPUT = 3208.5033858631236 samples/s
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 75.2601854801178s, BATCH = 32 AVG. THROUGHPUT = 3184.025500595342 samples/s, AVG. LATENCY = 18.814843475818634
Test Loss: 11718757139443456.000000

Test Loss: 11718757139443456.000000

Test Loss: 11718757139443456.000000
Test Loss: 11718757139443456.000000


Test Loss: 11718757139443456.000000

Test Loss: 11718757139443456.000000

Test Loss: 11718757139443456.000000


Test Accuracy (Overall): 15.7800% (1578/10000)
Test Accuracy (Overall): 15.7800% (1578/10000)
Test Accuracy (Overall): 15.7800% (1578/10000)
Test Accuracy (Overall): 15.7800% (1578/10000)




Test Accuracy (Overall): 15.7800% (1578/10000)
Test Accuracy (Overall): 15.7800% (1578/10000)


Test Accuracy (Overall): 15.7800% (1578/10000)
Test Loss: 11718757139443456.000000


Test Accuracy (Overall): 15.7800% (1578/10000)
Best ips: 3184.025500595342, Latency: 0.07978797875917874, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 3
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2775 and data parallel seed: 57
[60310] rank = 0, world_size = 3
[60312] rank = 2, world_size = 3
[60311] rank = 1, world_size = 3
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.020014870166778564, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 71974484229360689152.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 35.790159463882446s, THROUGHPUT = 1676.4384651750115 samples/s
Epoch: 2 	Training Loss: 36614208732793024.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 35.52483606338501s, THROUGHPUT = 1688.9592366575682 samples/s
Epoch: 3 	Training Loss: 16596552929739084.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 36.05658841133118s, THROUGHPUT = 1664.0509444632967 samples/s
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 143.18400144577026s, BATCH = 32 AVG. THROUGHPUT = 1676.2194575222375 samples/s, AVG. LATENCY = 35.79588061571121
Epoch: 4 	Training Loss: 10078671355169788.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 35.81648325920105s, THROUGHPUT = 1675.2063446817142 samples/s
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 143.1891224384308s, BATCH = 32 AVG. THROUGHPUT = 1676.1637477443974 samples/s, AVG. LATENCY = 35.79701679944992
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 143.1129548549652s, BATCH = 32 AVG. THROUGHPUT = 1677.0580815763453 samples/s, AVG. LATENCY = 35.778103947639465
Test Loss: 1451711303850026.500000

Test Loss: 1451711303850026.500000
Test Loss: 1451711303850026.500000



Test Accuracy (Overall): 15.5100% (1551/10000)

Test Accuracy (Overall): 15.5100% (1551/10000)
Test Accuracy (Overall): 15.5100% (1551/10000)

Best ips: 1676.1637477443974, Latency: 0.05730637321472168, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2743 and data parallel seed: 25
[63022] rank = 1, world_size = 4
[63021] rank = 0, world_size = 4
[63023] rank = 2, world_size = 4
[63024] rank = 3, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.021799135208129882, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 554639448860542435328.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 28.357038259506226s, THROUGHPUT = 2112.4914193011036 samples/s
Epoch: 2 	Training Loss: 197056207401721888.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 27.82215118408203s, THROUGHPUT = 2153.1045390290687 samples/s
Epoch: 3 	Training Loss: 77026436305900768.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 27.704359531402588s, THROUGHPUT = 2162.258973433386 samples/s
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 111.54840898513794s, BATCH = 32 AVG. THROUGHPUT = 2148.2249751846603 samples/s, AVG. LATENCY = 27.886956691741943
Epoch: 4 	Training Loss: 48113136748385880.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 27.786038398742676s, THROUGHPUT = 2155.902872527185 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 111.67032432556152s, BATCH = 32 AVG. THROUGHPUT = 2145.9394510726856 samples/s, AVG. LATENCY = 27.91739684343338
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 111.56920957565308s, BATCH = 32 AVG. THROUGHPUT = 2147.8269565559585 samples/s, AVG. LATENCY = 27.892160713672638
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 111.5593900680542s, BATCH = 32 AVG. THROUGHPUT = 2148.008873701514 samples/s, AVG. LATENCY = 27.889737963676453
Test Loss: 4157680987383687.000000

Test Loss: 4157680987383687.000000

Test Loss: 4157680987383687.000000


Test Accuracy (Overall): 8.5400% (854/10000)

Test Accuracy (Overall): 8.5400% (854/10000)
Test Accuracy (Overall): 8.5400% (854/10000)

Test Loss: 4157680987383687.000000


Test Accuracy (Overall): 8.5400% (854/10000)
Best ips: 2145.9394510726856, Latency: 0.05937187692039033, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 5
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2776 and data parallel seed: 58
[66733] rank = 4, world_size = 5
[66731] rank = 2, world_size = 5
[66732] rank = 3, world_size = 5
[66729] rank = 0, world_size = 5
[66730] rank = 1, world_size = 5
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.030397570133209227, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 77059812660426407936.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 27.127023220062256s, THROUGHPUT = 2211.8165901677694 samples/s
Epoch: 2 	Training Loss: 34461875526122620.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 26.645955324172974s, THROUGHPUT = 2251.748877833197 samples/s
Epoch: 3 	Training Loss: 14617399929507816.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 26.437077522277832s, THROUGHPUT = 2269.539813901123 samples/s
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 106.65399432182312s, BATCH = 32 AVG. THROUGHPUT = 2250.5102539754353 samples/s, AVG. LATENCY = 26.663344621658325
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 106.66819024085999s, BATCH = 32 AVG. THROUGHPUT = 2250.2192094528377 samples/s, AVG. LATENCY = 26.666927337646484
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 106.67039775848389s, BATCH = 32 AVG. THROUGHPUT = 2250.1726547037692 samples/s, AVG. LATENCY = 26.66744101047516
Epoch: 4 	Training Loss: 8865512133081974.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 26.45743441581726s, THROUGHPUT = 2267.793583346453 samples/s
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 106.66838479042053s, BATCH = 32 AVG. THROUGHPUT = 2250.2247163121356 samples/s, AVG. LATENCY = 26.66687262058258
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 106.69029450416565s, BATCH = 32 AVG. THROUGHPUT = 2249.73143834557 samples/s, AVG. LATENCY = 26.67245990037918
Test Loss: 3407781110975824.000000

Test Loss: 3407781110975824.000000

Test Loss: 3407781110975824.000000
Test Loss: 3407781110975824.000000



Test Accuracy (Overall): 14.7700% (1477/10000)
Test Accuracy (Overall): 14.7700% (1477/10000)


Test Accuracy (Overall): 14.7700% (1477/10000)
Test Accuracy (Overall): 14.7700% (1477/10000)

Test Loss: 3407781110975824.000000


Test Accuracy (Overall): 14.7700% (1477/10000)
Best ips: 2250.2247163121356, Latency: 0.07055315844217937, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 6
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2739 and data parallel seed: 21
[71219] rank = 1, world_size = 6
[71221] rank = 3, world_size = 6
[71218] rank = 0, world_size = 6
[71223] rank = 5, world_size = 6
[71222] rank = 4, world_size = 6
[71220] rank = 2, world_size = 6
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.031652307510375975, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 644385762239283584.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 22.615823984146118s, THROUGHPUT = 2648.764866670045 samples/s
Epoch: 2 	Training Loss: 209413656126458.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 22.392324924468994s, THROUGHPUT = 2675.2023383932096 samples/s
Epoch: 3 	Training Loss: 100388305600704.234375
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 22.538074254989624s, THROUGHPUT = 2657.9023266257127 samples/s
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 90.10027289390564s, BATCH = 32 AVG. THROUGHPUT = 2659.4808789627455 samples/s, AVG. LATENCY = 22.52495175600052
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 90.11029934883118s, BATCH = 32 AVG. THROUGHPUT = 2659.187309505924 samples/s, AVG. LATENCY = 22.527471005916595
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 90.01611614227295s, BATCH = 32 AVG. THROUGHPUT = 2661.9591386255297 samples/s, AVG. LATENCY = 22.503925323486328
Epoch: 4 	Training Loss: 59526622339085.109375
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 22.572694778442383s, THROUGHPUT = 2653.825809810274 samples/s
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 90.11975908279419s, BATCH = 32 AVG. THROUGHPUT = 2658.9238353748106 samples/s, AVG. LATENCY = 22.52972948551178
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 90.1381528377533s, BATCH = 32 AVG. THROUGHPUT = 2658.3712546903034 samples/s, AVG. LATENCY = 22.53441447019577
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 90.03405809402466s, BATCH = 32 AVG. THROUGHPUT = 2661.4284293619103 samples/s, AVG. LATENCY = 22.508425176143646
Test Loss: 52133627761891.734375
Test Loss: 52133627761891.734375


Test Loss: 52133627761891.734375

Test Loss: 52133627761891.734375

Test Loss: 52133627761891.734375
Test Loss: 52133627761891.734375



Test Accuracy (Overall): 16.1300% (1613/10000)
Test Accuracy (Overall): 16.1300% (1613/10000)


Test Accuracy (Overall): 16.1300% (1613/10000)

Test Accuracy (Overall): 16.1300% (1613/10000)

Test Accuracy (Overall): 16.1300% (1613/10000)

Test Accuracy (Overall): 16.1300% (1613/10000)
Best ips: 2658.9238353748106, Latency: 0.07234838070013584, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 7
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2762 and data parallel seed: 44
[76596] rank = 3, world_size = 7
[76593] rank = 0, world_size = 7
[76595] rank = 2, world_size = 7
[76598] rank = 5, world_size = 7
[76594] rank = 1, world_size = 7
[76597] rank = 4, world_size = 7
[76599] rank = 6, world_size = 7
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03313394784927368, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 52498374570607730688.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 19.91069006919861s, THROUGHPUT = 3003.813518875553 samples/s
Epoch: 2 	Training Loss: 16928513628670542.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 19.937577724456787s, THROUGHPUT = 2999.762600380258 samples/s
Epoch: 3 	Training Loss: 8241182419495105.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 19.75195860862732s, THROUGHPUT = 3027.952882296791 samples/s
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 79.6007194519043s, BATCH = 32 AVG. THROUGHPUT = 3005.486843943521 samples/s, AVG. LATENCY = 19.900033950805664
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 79.60323572158813s, BATCH = 32 AVG. THROUGHPUT = 3005.3907727382366 samples/s, AVG. LATENCY = 19.900658786296844
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 79.6071789264679s, BATCH = 32 AVG. THROUGHPUT = 3005.2457657540926 samples/s, AVG. LATENCY = 19.901621997356415
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 79.60829472541809s, BATCH = 32 AVG. THROUGHPUT = 3005.1885909990488 samples/s, AVG. LATENCY = 19.90192359685898
Epoch: 4 	Training Loss: 5284490190915144.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 20.007190227508545s, THROUGHPUT = 2989.325303548522 samples/s
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 79.60827112197876s, BATCH = 32 AVG. THROUGHPUT = 3005.213576275281 samples/s, AVG. LATENCY = 19.901854157447815
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 79.62303924560547s, BATCH = 32 AVG. THROUGHPUT = 3004.6530536526407 samples/s, AVG. LATENCY = 19.905584812164307RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 79.61804699897766s, BATCH = 32 AVG. THROUGHPUT = 3004.8433527171333 samples/s, AVG. LATENCY = 19.904331862926483

Test Loss: 5243799905114889.000000

Test Loss: 5243799905114889.000000
Test Loss: 5243799905114889.000000


Test Loss: 5243799905114889.000000

Test Loss: 5243799905114889.000000


Test Accuracy (Overall): 18.2800% (1828/10000)

Test Accuracy (Overall): 18.2800% (1828/10000)

Test Accuracy (Overall): 18.2800% (1828/10000)

Test Accuracy (Overall): 18.2800% (1828/10000)

Test Accuracy (Overall): 18.2800% (1828/10000)
Test Loss: 5243799905114889.000000
Test Loss: 5243799905114889.000000



Test Accuracy (Overall): 18.2800% (1828/10000)

Test Accuracy (Overall): 18.2800% (1828/10000)
Best ips: 3005.213576275281, Latency: 0.07493329673224174, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 8
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2729 and data parallel seed: 11
[82861] rank = 5, world_size = 8
[82858] rank = 2, world_size = 8
[82859] rank = 3, world_size = 8
[82862] rank = 6, world_size = 8
[82857] rank = 1, world_size = 8
[82856] rank = 0, world_size = 8
[82860] rank = 4, world_size = 8[82863] rank = 7, world_size = 8

finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03242677450180054, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 40964098961922695168.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 17.33592700958252s, THROUGHPUT = 3455.4829382292487 samples/s
Epoch: 2 	Training Loss: 20001379009728140.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 17.218092679977417s, THROUGHPUT = 3479.130999780318 samples/s
Epoch: 3 	Training Loss: 10357502113503494.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 17.133666276931763s, THROUGHPUT = 3496.274471077617 samples/s
Epoch: 4 	Training Loss: 6606845768492699.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 17.226834297180176s, THROUGHPUT = 3477.3655430008725 samples/s
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 68.91547656059265s, BATCH = 32 AVG. THROUGHPUT = 3477.063488022014 samples/s, AVG. LATENCY = 17.22863006591797
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 68.92123794555664s, BATCH = 32 AVG. THROUGHPUT = 3476.741534501807 samples/s, AVG. LATENCY = 17.23018491268158
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 68.7893693447113s, BATCH = 32 AVG. THROUGHPUT = 3483.3641164006135 samples/s, AVG. LATENCY = 17.19724267721176
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 68.92356705665588s, BATCH = 32 AVG. THROUGHPUT = 3476.628519967745 samples/s, AVG. LATENCY = 17.230792760849
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 68.78272032737732s, BATCH = 32 AVG. THROUGHPUT = 3483.697327507524 samples/s, AVG. LATENCY = 17.195587515830994
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 68.78888010978699s, BATCH = 32 AVG. THROUGHPUT = 3483.377244679127 samples/s, AVG. LATENCY = 17.1971173286438
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 68.94598579406738s, BATCH = 32 AVG. THROUGHPUT = 3475.4605301152437 samples/s, AVG. LATENCY = 17.236393749713898
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 68.83276152610779s, BATCH = 32 AVG. THROUGHPUT = 3481.1760874173915 samples/s, AVG. LATENCY = 17.20809370279312
Test Loss: 3736128467235556.500000

Test Loss: 3736128467235556.500000

Test Loss: 3736128467235556.500000
Test Loss: 3736128467235556.500000


Test Loss: 3736128467235556.500000


Test Accuracy (Overall): 16.4000% (1640/10000)

Test Accuracy (Overall): 16.4000% (1640/10000)
Test Loss: 3736128467235556.500000


Test Accuracy (Overall): 16.4000% (1640/10000)

Test Accuracy (Overall): 16.4000% (1640/10000)
Test Loss: 3736128467235556.500000


Test Accuracy (Overall): 16.4000% (1640/10000)

Test Accuracy (Overall): 16.4000% (1640/10000)

Test Accuracy (Overall): 16.4000% (1640/10000)
Test Loss: 3736128467235556.500000


Test Accuracy (Overall): 16.4000% (1640/10000)
Best ips: 3477.063488022014, Latency: 0.07361894998794948, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
> initializing model parallel with size 1
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2731 and data parallel seed: 13
[45] rank = 0, world_size = 1
finding optimal strategy
optimal latency: 0.009668183326721192, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 33706950936591147008.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 87.87407445907593s, THROUGHPUT = 682.7952427304684 samples/s
Epoch: 2 	Training Loss: 6749813917620092.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 87.81218695640564s, THROUGHPUT = 683.2764571708822 samples/s
Epoch: 3 	Training Loss: 2153836862193742.750000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 88.37438488006592s, THROUGHPUT = 678.9297609417799 samples/s
Epoch: 4 	Training Loss: 915056297869574.125000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 88.0281286239624s, THROUGHPUT = 681.6003127398895 samples/s
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 352.0896282196045s, BATCH = 32 AVG. THROUGHPUT = 681.650443395755 samples/s, AVG. LATENCY = 88.02219372987747
Test Loss: 42422461268387.429688


Test Accuracy (Overall): 16.1600% (1616/10000)
Best ips: 681.650443395755, Latency: 0.04694833526611328, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 2
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2737 and data parallel seed: 19
[1013] rank = 0, world_size = 2
[1014] rank = 1, world_size = 2
finding optimal strategy
finding optimal strategy
optimal latency: 0.017045199871063232, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 62472108493773160448.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 55.188392162323s, THROUGHPUT = 1086.6053104721545 samples/s
Epoch: 2 	Training Loss: 22703642724359000.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 55.216779470443726s, THROUGHPUT = 1086.046679562315 samples/s
Epoch: 3 	Training Loss: 9137127741781722.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 55.384116411209106s, THROUGHPUT = 1082.7653104503293 samples/s
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 220.81191110610962s, BATCH = 32 AVG. THROUGHPUT = 1086.3269828726447 samples/s, AVG. LATENCY = 55.20286065340042
Epoch: 4 	Training Loss: 5184823976440540.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 55.022160053253174s, THROUGHPUT = 1089.888145829971 samples/s
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 220.81230664253235s, BATCH = 32 AVG. THROUGHPUT = 1086.3263615786923 samples/s, AVG. LATENCY = 55.20286202430725
Test Loss: 1068784840216045.125000

Test Loss: 1068784840216045.125000

Test Accuracy (Overall): 14.5200% (1452/10000)


Test Accuracy (Overall): 14.5200% (1452/10000)
Best ips: 1086.3263615786923, Latency: 0.05872162225533956, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 3
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2738 and data parallel seed: 20
[2604] rank = 1, world_size = 3
[2603] rank = 0, world_size = 3
[2605] rank = 2, world_size = 3
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.021485257148742675, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 87427202255284043776.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 40.35474252700806s, THROUGHPUT = 1486.8140952663505 samples/s
Epoch: 2 	Training Loss: 34194648135617148.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 40.36021018028259s, THROUGHPUT = 1486.612674512586 samples/s
Epoch: 3 	Training Loss: 13480875636511176.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 40.40665102005005s, THROUGHPUT = 1484.9040562710234 samples/s
Epoch: 4 	Training Loss: 7656600742455743.000000
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 40.435646295547485s, THROUGHPUT = 1483.8392729389072 samples/s
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 161.5580689907074s, BATCH = 32 AVG. THROUGHPUT = 1485.5425247472167 samples/s, AVG. LATENCY = 40.389312505722046
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 161.55597186088562s, BATCH = 32 AVG. THROUGHPUT = 1485.5579453142811 samples/s, AVG. LATENCY = 40.388898849487305
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 161.56385374069214s, BATCH = 32 AVG. THROUGHPUT = 1485.4873518506786 samples/s, AVG. LATENCY = 40.39081412553787
Test Loss: 2326132429136540.500000

Test Loss: 2326132429136540.500000


Test Accuracy (Overall): 17.2800% (1728/10000)
Test Accuracy (Overall): 17.2800% (1728/10000)

Test Loss: 2326132429136540.500000


Test Accuracy (Overall): 17.2800% (1728/10000)
Best ips: 1485.5425247472167, Latency: 0.06469703407287597, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2757 and data parallel seed: 39
[4882] rank = 0, world_size = 4
[4885] rank = 3, world_size = 4
[4883] rank = 1, world_size = 4
[4884] rank = 2, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.022063934803009035, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 101454697989043011584.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 31.35995054244995s, THROUGHPUT = 1910.207094201625 samples/s
Epoch: 2 	Training Loss: 57376075480824320.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.530792474746704s, THROUGHPUT = 1962.0846740073682 samples/s
Epoch: 3 	Training Loss: 27314602707770776.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.62627625465393s, THROUGHPUT = 1955.9674673442241 samples/s
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 123.15379810333252s, BATCH = 32 AVG. THROUGHPUT = 1945.9000732286588 samples/s, AVG. LATENCY = 30.78833907842636
Epoch: 4 	Training Loss: 16478335068172208.000000
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 30.63477087020874s, THROUGHPUT = 1955.4251035138172 samples/s
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 123.15255522727966s, BATCH = 32 AVG. THROUGHPUT = 1945.9210847667587 samples/s, AVG. LATENCY = 30.78794753551483
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 123.16602230072021s, BATCH = 32 AVG. THROUGHPUT = 1945.7049939482424 samples/s, AVG. LATENCY = 30.791404724121094
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 123.16910982131958s, BATCH = 32 AVG. THROUGHPUT = 1945.6635088319406 samples/s, AVG. LATENCY = 30.792120277881622
Test Loss: 5838169865736264.000000

Test Loss: 5838169865736264.000000

Test Loss: 5838169865736264.000000


Test Accuracy (Overall): 16.1500% (1615/10000)

Test Accuracy (Overall): 16.1500% (1615/10000)

Test Accuracy (Overall): 16.1500% (1615/10000)
Best ips: 1945.9210847667587, Latency: 0.06545891211583064, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
Test Loss: 5838169865736264.000000


Test Accuracy (Overall): 16.1500% (1615/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 5
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2740 and data parallel seed: 22
[8016] rank = 2, world_size = 5
[8015] rank = 1, world_size = 5
[8017] rank = 3, world_size = 5
[8018] rank = 4, world_size = 5
[8014] rank = 0, world_size = 5
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03158200979232788, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 83085382970596900864.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 29.08863592147827s, THROUGHPUT = 2062.6611767552017 samples/s
Epoch: 2 	Training Loss: 98823335767058336.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.98691725730896s, THROUGHPUT = 2069.899308967434 samples/s
Epoch: 3 	Training Loss: 38955133958012080.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.581817865371704s, THROUGHPUT = 2099.2366644632843 samples/s
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 115.21150159835815s, BATCH = 32 AVG. THROUGHPUT = 2083.263178526715 samples/s, AVG. LATENCY = 28.802741706371307
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 115.22042179107666s, BATCH = 32 AVG. THROUGHPUT = 2083.1075447067014 samples/s, AVG. LATENCY = 28.80498367547989
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 115.24147653579712s, BATCH = 32 AVG. THROUGHPUT = 2082.7309362050482 samples/s, AVG. LATENCY = 28.81026327610016
Epoch: 4 	Training Loss: 22206057461317352.000000
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 28.573520183563232s, THROUGHPUT = 2099.8462777615578 samples/s
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 115.23160743713379s, BATCH = 32 AVG. THROUGHPUT = 2082.9108569868695 samples/s, AVG. LATENCY = 28.807722806930542
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 115.22337079048157s, BATCH = 32 AVG. THROUGHPUT = 2083.04750317883 samples/s, AVG. LATENCY = 28.805737257003784
Test Loss: 12309097331107980.000000

Test Loss: 12309097331107980.000000
Test Loss: 12309097331107980.000000


Test Loss: 12309097331107980.000000


Test Accuracy (Overall): 13.4100% (1341/10000)

Test Accuracy (Overall): 13.4100% (1341/10000)
Test Accuracy (Overall): 13.4100% (1341/10000)


Test Accuracy (Overall): 13.4100% (1341/10000)
Test Loss: 12309097331107980.000000


Test Accuracy (Overall): 13.4100% (1341/10000)
Best ips: 2082.9108569868695, Latency: 0.07619605382283529, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 6
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2768 and data parallel seed: 50
[11784] rank = 3, world_size = 6
[11785] rank = 4, world_size = 6
[11783] rank = 2, world_size = 6[11781] rank = 0, world_size = 6

[11782] rank = 1, world_size = 6
[11786] rank = 5, world_size = 6
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03300275802612305, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 107892955593341534208.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.914191484451294s, THROUGHPUT = 2404.4127636004364 samples/s
Epoch: 2 	Training Loss: 54109435702668584.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.53349995613098s, THROUGHPUT = 2441.7225470118806 samples/s
Epoch: 3 	Training Loss: 24181665222598484.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.895073175430298s, THROUGHPUT = 2406.259245669584 samples/s
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 98.88768172264099s, BATCH = 32 AVG. THROUGHPUT = 2423.3363260253827 samples/s, AVG. LATENCY = 24.721759021282196
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 98.89294385910034s, BATCH = 32 AVG. THROUGHPUT = 2423.192718519716 samples/s, AVG. LATENCY = 24.723118484020233
Epoch: 4 	Training Loss: 14202295701745540.000000
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 24.467533349990845s, THROUGHPUT = 2448.305644182249 samples/s
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 98.81106305122375s, BATCH = 32 AVG. THROUGHPUT = 2425.1750501160377 samples/s, AVG. LATENCY = 24.702574491500854
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 98.90410494804382s, BATCH = 32 AVG. THROUGHPUT = 2422.9211248228535 samples/s, AVG. LATENCY = 24.725903511047363
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 98.90259861946106s, BATCH = 32 AVG. THROUGHPUT = 2422.9571045668713 samples/s, AVG. LATENCY = 24.72553837299347
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 98.92034816741943s, BATCH = 32 AVG. THROUGHPUT = 2422.5412060747876 samples/s, AVG. LATENCY = 24.72995889186859
Test Loss: 5564298737781152.000000

Test Loss: 5564298737781152.000000

Test Loss: 5564298737781152.000000

Test Loss: 5564298737781152.000000

Test Loss: 5564298737781152.000000


Test Accuracy (Overall): 12.6900% (1269/10000)
Test Accuracy (Overall): 12.6900% (1269/10000)


Test Accuracy (Overall): 12.6900% (1269/10000)
Test Accuracy (Overall): 12.6900% (1269/10000)


Test Accuracy (Overall): 12.6900% (1269/10000)
Test Loss: 5564298737781152.000000


Test Accuracy (Overall): 12.6900% (1269/10000)
Best ips: 2425.1750501160377, Latency: 0.07842158124997066, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 7
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2733 and data parallel seed: 15
[16295] rank = 3, world_size = 7
[16297] rank = 5, world_size = 7
[16292] rank = 0, world_size = 7
[16294] rank = 2, world_size = 7
[16298] rank = 6, world_size = 7
[16296] rank = 4, world_size = 7
[16293] rank = 1, world_size = 7
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.03393144607543945, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 57312313263225462784.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.43684220314026s, THROUGHPUT = 2789.963159370497 samples/s
Epoch: 2 	Training Loss: 32359816542594148.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.35365319252014s, THROUGHPUT = 2800.8322257921577 samples/s
Epoch: 3 	Training Loss: 14897180739761358.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.502246618270874s, THROUGHPUT = 2781.4767945773624 samples/s
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 85.63221454620361s, BATCH = 32 AVG. THROUGHPUT = 2793.757212843605 samples/s, AVG. LATENCY = 21.407902598381042
Epoch: 4 	Training Loss: 8585502198349099.000000
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 21.334006786346436s, THROUGHPUT = 2803.4115015973725 samples/s
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 85.62751793861389s, BATCH = 32 AVG. THROUGHPUT = 2793.9209203343476 samples/s, AVG. LATENCY = 21.406687200069427
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 85.63105535507202s, BATCH = 32 AVG. THROUGHPUT = 2793.78541286321 samples/s, AVG. LATENCY = 21.40760999917984
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 85.64026522636414s, BATCH = 32 AVG. THROUGHPUT = 2793.486700942163 samples/s, AVG. LATENCY = 21.409940361976624
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 85.62839937210083s, BATCH = 32 AVG. THROUGHPUT = 2793.8827259968966 samples/s, AVG. LATENCY = 21.406995952129364
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 85.63123655319214s, BATCH = 32 AVG. THROUGHPUT = 2793.783512537464 samples/s, AVG. LATENCY = 21.40765804052353
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 85.64554190635681s, BATCH = 32 AVG. THROUGHPUT = 2793.3071467539003 samples/s, AVG. LATENCY = 21.411280930042267
Test Loss: 10495604944651734.000000
Test Loss: 10495604944651734.000000
Test Loss: 10495604944651734.000000



Test Loss: 10495604944651734.000000

Test Loss: 10495604944651734.000000

Test Loss: 10495604944651734.000000


Test Accuracy (Overall): 11.6900% (1169/10000)

Test Accuracy (Overall): 11.6900% (1169/10000)

Test Accuracy (Overall): 11.6900% (1169/10000)

Test Accuracy (Overall): 11.6900% (1169/10000)
Test Loss: 10495604944651734.000000

Test Accuracy (Overall): 11.6900% (1169/10000)
Test Accuracy (Overall): 11.6900% (1169/10000)



Test Accuracy (Overall): 11.6900% (1169/10000)
Best ips: 2793.9209203343476, Latency: 0.07990264713987429, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 8
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2750 and data parallel seed: 32
[21553] rank = 6, world_size = 8
[21552] rank = 5, world_size = 8
[21547] rank = 0, world_size = 8
[21554] rank = 7, world_size = 8
[21551] rank = 4, world_size = 8
[21550] rank = 3, world_size = 8
[21549] rank = 2, world_size = 8
[21548] rank = 1, world_size = 8
finding optimal strategy
finding optimal strategyfinding optimal strategy

finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
optimal latency: 0.033206844329833986, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 126791087708912353280.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 18.766610622406006s, THROUGHPUT = 3192.0521614317963 samples/s
Epoch: 2 	Training Loss: 39969149934724816.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 18.785494327545166s, THROUGHPUT = 3188.843421179648 samples/s
Epoch: 3 	Training Loss: 15429279750680968.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 18.54476809501648s, THROUGHPUT = 3230.2372126237565 samples/s
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 75.39430069923401s, BATCH = 32 AVG. THROUGHPUT = 3178.685106603215 samples/s, AVG. LATENCY = 18.84845495223999
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 75.39518594741821s, BATCH = 32 AVG. THROUGHPUT = 3178.665464618728 samples/s, AVG. LATENCY = 18.848665237426758
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 75.39490723609924s, BATCH = 32 AVG. THROUGHPUT = 3178.663299956613 samples/s, AVG. LATENCY = 18.84862095117569
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 75.40058875083923s, BATCH = 32 AVG. THROUGHPUT = 3178.338035029702 samples/s, AVG. LATENCY = 18.850032091140747
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 75.40071606636047s, BATCH = 32 AVG. THROUGHPUT = 3178.417658037155 samples/s, AVG. LATENCY = 18.850037932395935
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 75.40281796455383s, BATCH = 32 AVG. THROUGHPUT = 3178.3396587040074 samples/s, AVG. LATENCY = 18.850584089756012
Epoch: 4 	Training Loss: 8907225204784733.000000
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 19.223637580871582s, THROUGHPUT = 3116.1636161725855 samples/s
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 75.32115578651428s, BATCH = 32 AVG. THROUGHPUT = 3181.8241028519465 samples/s, AVG. LATENCY = 18.83012765645981
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 75.39961886405945s, BATCH = 32 AVG. THROUGHPUT = 3178.4636784949 samples/s, AVG. LATENCY = 18.849767208099365
Test Loss: 5089540970653522.000000
Test Loss: 5089540970653522.000000
Test Loss: 5089540970653522.000000
Test Loss: 5089540970653522.000000




Test Loss: 5089540970653522.000000

Test Loss: 5089540970653522.000000

Test Loss: 5089540970653522.000000

Test Loss: 5089540970653522.000000


Test Accuracy (Overall): 10.4600% (1046/10000)

Test Accuracy (Overall): 10.4600% (1046/10000)
Test Accuracy (Overall): 10.4600% (1046/10000)
Test Accuracy (Overall): 10.4600% (1046/10000)



Test Accuracy (Overall): 10.4600% (1046/10000)
Test Accuracy (Overall): 10.4600% (1046/10000)
Test Accuracy (Overall): 10.4600% (1046/10000)



Test Accuracy (Overall): 10.4600% (1046/10000)
Best ips: 3181.8241028519465, Latency: 0.08215229735415205, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
