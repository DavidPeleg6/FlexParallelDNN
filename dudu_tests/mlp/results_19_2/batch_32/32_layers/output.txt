Strong scaling
> initializing model parallel with size 1
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2739 and data parallel seed: 21
[83657] rank = 0, world_size = 1
finding optimal strategy
iteration: 0, current latency: 0.0098, best latency: 0.0098 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0114, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0100, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0113, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 170, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 180, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 190, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 200, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 210, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 220, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 230, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 240, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 250, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 260, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 270, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 280, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 290, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 300, current latency: 0.0098, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 310, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 320, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 330, current latency: 0.0113, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 340, current latency: 0.0116, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 350, current latency: 0.0100, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 360, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 370, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 380, current latency: 0.0096, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 390, current latency: 0.0097, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 400, current latency: 0.0099, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 410, current latency: 0.0096, best latency: 0.0095 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 420, current latency: 0.0095, best latency: 0.0094 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 430, current latency: 0.0095, best latency: 0.0094 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 440, current latency: 0.0097, best latency: 0.0093 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 450, current latency: 0.0097, best latency: 0.0093 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 460, current latency: 0.0097, best latency: 0.0093 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 470, current latency: 0.0108, best latency: 0.0093 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 480, current latency: 0.0095, best latency: 0.0093 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 490, current latency: 0.0095, best latency: 0.0093 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 500, current latency: 0.0092, best latency: 0.0092 baseline latency: 0.0098
no new strategies could be found
iteration: 510, current latency: 0.0094, best latency: 0.0092 baseline latency: 0.0098
iteration: 520, current latency: 0.0093, best latency: 0.0091 baseline latency: 0.0098
iteration: 530, current latency: 0.0091, best latency: 0.0090 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 540, current latency: 0.0091, best latency: 0.0090 baseline latency: 0.0098
iteration: 550, current latency: 0.0090, best latency: 0.0089 baseline latency: 0.0098
no new strategies could be found
no new strategies could be found
iteration: 560, current latency: 0.0090, best latency: 0.0088 baseline latency: 0.0098
iteration: 570, current latency: 0.0090, best latency: 0.0088 baseline latency: 0.0098
no new strategies could be found
iteration: 580, current latency: 0.0086, best latency: 0.0086 baseline latency: 0.0098
iteration: 590, current latency: 0.0085, best latency: 0.0085 baseline latency: 0.0098
iteration: 600, current latency: 0.0086, best latency: 0.0084 baseline latency: 0.0098
iteration: 610, current latency: 0.0088, best latency: 0.0084 baseline latency: 0.0098
iteration: 620, current latency: 0.0084, best latency: 0.0084 baseline latency: 0.0098
iteration: 630, current latency: 0.0085, best latency: 0.0084 baseline latency: 0.0098
iteration: 640, current latency: 0.0085, best latency: 0.0084 baseline latency: 0.0098
iteration: 650, current latency: 0.0088, best latency: 0.0084 baseline latency: 0.0098
iteration: 660, current latency: 0.0085, best latency: 0.0084 baseline latency: 0.0098
iteration: 670, current latency: 0.0087, best latency: 0.0084 baseline latency: 0.0098
iteration: 680, current latency: 0.0089, best latency: 0.0084 baseline latency: 0.0098
iteration: 690, current latency: 0.0088, best latency: 0.0084 baseline latency: 0.0098
iteration: 700, current latency: 0.0086, best latency: 0.0084 baseline latency: 0.0098
iteration: 710, current latency: 0.0087, best latency: 0.0084 baseline latency: 0.0098
iteration: 720, current latency: 0.0090, best latency: 0.0084 baseline latency: 0.0098
iteration: 730, current latency: 0.0087, best latency: 0.0084 baseline latency: 0.0098
iteration: 740, current latency: 0.0084, best latency: 0.0084 baseline latency: 0.0098
iteration: 750, current latency: 0.0085, best latency: 0.0084 baseline latency: 0.0098
iteration: 760, current latency: 0.0085, best latency: 0.0082 baseline latency: 0.0098
iteration: 770, current latency: 0.0086, best latency: 0.0082 baseline latency: 0.0098
iteration: 780, current latency: 0.0084, best latency: 0.0082 baseline latency: 0.0098
iteration: 790, current latency: 0.0084, best latency: 0.0082 baseline latency: 0.0098
iteration: 800, current latency: 0.0100, best latency: 0.0082 baseline latency: 0.0098
iteration: 810, current latency: 0.0099, best latency: 0.0082 baseline latency: 0.0098
iteration: 820, current latency: 0.0103, best latency: 0.0082 baseline latency: 0.0098
iteration: 830, current latency: 0.0101, best latency: 0.0082 baseline latency: 0.0098
iteration: 840, current latency: 0.0098, best latency: 0.0082 baseline latency: 0.0098
iteration: 850, current latency: 0.0100, best latency: 0.0082 baseline latency: 0.0098
iteration: 860, current latency: 0.0083, best latency: 0.0082 baseline latency: 0.0098
iteration: 870, current latency: 0.0086, best latency: 0.0082 baseline latency: 0.0098
iteration: 880, current latency: 0.0100, best latency: 0.0082 baseline latency: 0.0098
iteration: 890, current latency: 0.0082, best latency: 0.0081 baseline latency: 0.0098
iteration: 900, current latency: 0.0085, best latency: 0.0081 baseline latency: 0.0098
iteration: 910, current latency: 0.0087, best latency: 0.0081 baseline latency: 0.0098
iteration: 920, current latency: 0.0085, best latency: 0.0081 baseline latency: 0.0098
iteration: 930, current latency: 0.0083, best latency: 0.0081 baseline latency: 0.0098
iteration: 940, current latency: 0.0083, best latency: 0.0081 baseline latency: 0.0098
iteration: 950, current latency: 0.0084, best latency: 0.0081 baseline latency: 0.0098
iteration: 960, current latency: 0.0084, best latency: 0.0081 baseline latency: 0.0098
iteration: 970, current latency: 0.0086, best latency: 0.0081 baseline latency: 0.0098
iteration: 980, current latency: 0.0085, best latency: 0.0081 baseline latency: 0.0098
iteration: 990, current latency: 0.0084, best latency: 0.0081 baseline latency: 0.0098
optimal latency: 0.008128857612609864, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": true
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 231150769556650655744.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 84.32249665260315s, THROUGHPUT = 711.5538839794033 samples/s
Epoch: 2 	Training Loss: 86404367528358976.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 83.37386298179626s, THROUGHPUT = 719.6499940646905 samples/s
Epoch: 3 	Training Loss: 29353038554323536.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 83.84129500389099s, THROUGHPUT = 715.6378011243202 samples/s
Epoch: 4 	Training Loss: 11272336131872592.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 84.57580471038818s, THROUGHPUT = 709.4227504598651 samples/s
Epoch: 5 	Training Loss: 4644173571746379.000000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 83.79500603675842s, THROUGHPUT = 716.0331246193807 samples/s
Epoch: 6 	Training Loss: 1956557818740377.750000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 85.07206106185913s, THROUGHPUT = 705.2844288840224 samples/s
Epoch: 7 	Training Loss: 850771434235669.125000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 85.32154583930969s, THROUGHPUT = 703.2221393761546 samples/s
Epoch: 8 	Training Loss: 374417708321743.375000
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 84.56057476997375s, THROUGHPUT = 709.5505223706821 samples/s
Epoch: 9 	Training Loss: 157231336834832.781250
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 84.27405953407288s, THROUGHPUT = 711.9628546639714 samples/s
Epoch: 10 	Training Loss: 66520679608239.171875
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 84.37103867530823s, THROUGHPUT = 711.1444986579195 samples/s
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 843.509450674057s, BATCH = 32 AVG. THROUGHPUT = 711.346199820041 samples/s, AVG. LATENCY = 84.35077452659607
Test Loss: 151885850424.115204


Test Accuracy (Overall): 12.2300% (1223/10000)
Best ips: 711.346199820041, Latency: 0.04499788729349772, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": true
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 2
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2718 and data parallel seed: 0
[5410] rank = 0, world_size = 2
[5411] rank = 1, world_size = 2
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0204, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0187, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0168, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0168, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0168, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0168, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.0168, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.0167, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.0178, best latency: 0.0167 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 170, current latency: 0.0170, best latency: 0.0164 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 180, current latency: 0.0164, best latency: 0.0164 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 190, current latency: 0.0164, best latency: 0.0164 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 200, current latency: 0.0193, best latency: 0.0164 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 210, current latency: 0.0170, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 220, current latency: 0.0188, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 230, current latency: 0.0164, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 240, current latency: 0.0165, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 250, current latency: 0.0164, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 260, current latency: 0.0164, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 270, current latency: 0.0167, best latency: 0.0163 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 280, current latency: 0.0161, best latency: 0.0161 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 290, current latency: 0.0168, best latency: 0.0160 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 300, current latency: 0.0202, best latency: 0.0160 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 310, current latency: 0.0164, best latency: 0.0160 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 320, current latency: 0.0175, best latency: 0.0160 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 330, current latency: 0.0158, best latency: 0.0155 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 340, current latency: 0.0185, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 350, current latency: 0.0154, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 360, current latency: 0.0154, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 370, current latency: 0.0154, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 380, current latency: 0.0174, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 390, current latency: 0.0160, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 400, current latency: 0.0167, best latency: 0.0154 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 410, current latency: 0.0162, best latency: 0.0152 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 420, current latency: 0.0164, best latency: 0.0146 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 430, current latency: 0.0149, best latency: 0.0146 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 440, current latency: 0.0147, best latency: 0.0145 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 450, current latency: 0.0145, best latency: 0.0145 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 460, current latency: 0.0145, best latency: 0.0145 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 470, current latency: 0.0145, best latency: 0.0145 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 480, current latency: 0.0171, best latency: 0.0145 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 490, current latency: 0.0147, best latency: 0.0141 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 500, current latency: 0.0136, best latency: 0.0136 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 510, current latency: 0.0138, best latency: 0.0136 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 520, current latency: 0.0138, best latency: 0.0136 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 530, current latency: 0.0139, best latency: 0.0136 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 540, current latency: 0.0138, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 550, current latency: 0.0136, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 560, current latency: 0.0135, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 570, current latency: 0.0136, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 580, current latency: 0.0139, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 590, current latency: 0.0148, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 600, current latency: 0.0150, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 610, current latency: 0.0136, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 620, current latency: 0.0148, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 630, current latency: 0.0153, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
iteration: 640, current latency: 0.0148, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 650, current latency: 0.0150, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 660, current latency: 0.0165, best latency: 0.0135 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 670, current latency: 0.0132, best latency: 0.0129 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 680, current latency: 0.0149, best latency: 0.0129 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 690, current latency: 0.0134, best latency: 0.0128 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 700, current latency: 0.0129, best latency: 0.0128 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 710, current latency: 0.0132, best latency: 0.0128 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 720, current latency: 0.0133, best latency: 0.0128 baseline latency: 0.0167
no new strategies could be found
iteration: 730, current latency: 0.0126, best latency: 0.0126 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 740, current latency: 0.0127, best latency: 0.0126 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 750, current latency: 0.0191, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 760, current latency: 0.0128, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
iteration: 770, current latency: 0.0135, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
iteration: 780, current latency: 0.0146, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 790, current latency: 0.0125, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
iteration: 800, current latency: 0.0126, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 810, current latency: 0.0127, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
iteration: 820, current latency: 0.0141, best latency: 0.0125 baseline latency: 0.0167
no new strategies could be found
no new strategies could be found
iteration: 830, current latency: 0.0123, best latency: 0.0120 baseline latency: 0.0167
iteration: 840, current latency: 0.0121, best latency: 0.0119 baseline latency: 0.0167
iteration: 850, current latency: 0.0123, best latency: 0.0119 baseline latency: 0.0167
iteration: 860, current latency: 0.0124, best latency: 0.0119 baseline latency: 0.0167
iteration: 870, current latency: 0.0113, best latency: 0.0113 baseline latency: 0.0167
iteration: 880, current latency: 0.0121, best latency: 0.0110 baseline latency: 0.0167
iteration: 890, current latency: 0.0111, best latency: 0.0110 baseline latency: 0.0167
iteration: 900, current latency: 0.0110, best latency: 0.0102 baseline latency: 0.0167
iteration: 910, current latency: 0.0107, best latency: 0.0102 baseline latency: 0.0167
iteration: 920, current latency: 0.0113, best latency: 0.0102 baseline latency: 0.0167
iteration: 930, current latency: 0.0108, best latency: 0.0102 baseline latency: 0.0167
iteration: 940, current latency: 0.0108, best latency: 0.0102 baseline latency: 0.0167
iteration: 950, current latency: 0.0113, best latency: 0.0102 baseline latency: 0.0167
iteration: 960, current latency: 0.0113, best latency: 0.0102 baseline latency: 0.0167
iteration: 970, current latency: 0.0112, best latency: 0.0102 baseline latency: 0.0167
iteration: 980, current latency: 0.0118, best latency: 0.0102 baseline latency: 0.0167
iteration: 990, current latency: 0.0110, best latency: 0.0102 baseline latency: 0.0167
optimal latency: 0.01010584831237793, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": true
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})])
Epoch: 1 	Training Loss: 30703037669103546368.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.30871272087097s, THROUGHPUT = 643.0267683521413 samples/s
Epoch: 2 	Training Loss: 6825453651678672.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.24690222740173s, THROUGHPUT = 643.4530109501941 samples/s
Epoch: 3 	Training Loss: 1858248271906437.000000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.21412181854248s, THROUGHPUT = 643.6792926805709 samples/s
Epoch: 4 	Training Loss: 654796556939593.875000
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.21346545219421s, THROUGHPUT = 643.6838251740764 samples/s
Epoch: 5 	Training Loss: 271978663218092.437500
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.09653162956238s, THROUGHPUT = 644.4923237177536 samples/s
Epoch: 6 	Training Loss: 121931984066908.437500
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.82627987861633s, THROUGHPUT = 639.4796860498187 samples/s
Epoch: 7 	Training Loss: 57820043211177.984375
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 95.4637508392334s, THROUGHPUT = 628.5108166454045 samples/s
Epoch: 8 	Training Loss: 27586375711929.140625
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.39733719825745s, THROUGHPUT = 642.4166020133542 samples/s
Epoch: 9 	Training Loss: 12904447037616.947266
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.35148358345032s, THROUGHPUT = 642.7321526857556 samples/s
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 935.121648311615s, BATCH = 16 AVG. THROUGHPUT = 641.662338227032 samples/s, AVG. LATENCY = 93.51208741664887
Epoch: 10 	Training Loss: 5539572788232.192383
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 93.02435827255249s, THROUGHPUT = 644.9923559182824 samples/s
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 935.1443884372711s, BATCH = 16 AVG. THROUGHPUT = 641.6466834187352 samples/s, AVG. LATENCY = 93.51429436206817
Test Loss: 73601519868.313599

Test Loss: 73601519868.313599


Test Accuracy (Overall): 14.2500% (1425/10000)

Test Accuracy (Overall): 14.2500% (1425/10000)
Best ips: 641.6466834187352, Latency: 0.049612991078694664, Best strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": true
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": true,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
})]) 
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 3
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2770 and data parallel seed: 52
[20595] rank = 0, world_size = 3
[20596] rank = 1, world_size = 3
[20597] rank = 2, world_size = 3
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0212, best latency: 0.0212 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0246, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0241, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0259, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0212, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0212, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0236, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0224, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.0216, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.0216, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 170, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 180, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 190, current latency: 0.0240, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 200, current latency: 0.0230, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 210, current latency: 0.0213, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 220, current latency: 0.0234, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 230, current latency: 0.0216, best latency: 0.0210 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 240, current latency: 0.0203, best latency: 0.0203 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 250, current latency: 0.0211, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 260, current latency: 0.0244, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 270, current latency: 0.0216, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 280, current latency: 0.0215, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 290, current latency: 0.0202, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 300, current latency: 0.0208, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 310, current latency: 0.0208, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 320, current latency: 0.0202, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 330, current latency: 0.0250, best latency: 0.0202 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 340, current latency: 0.0194, best latency: 0.0194 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 350, current latency: 0.0213, best latency: 0.0194 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 360, current latency: 0.0198, best latency: 0.0194 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 370, current latency: 0.0204, best latency: 0.0189 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 380, current latency: 0.0197, best latency: 0.0186 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 390, current latency: 0.0192, best latency: 0.0186 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 400, current latency: 0.0205, best latency: 0.0181 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 410, current latency: 0.0248, best latency: 0.0181 baseline latency: 0.0212
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 3
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
AssertionError: 1024 is not divisible by 3
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 20595) of binary: /opt/conda/bin/python
Traceback (most recent call last):
  File "/opt/conda/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.10.0', 'console_scripts', 'torchrun')())
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 719, in main
    run(args)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 710, in run
    elastic_launch(
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
mnist_mlp.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2022-02-02_02:11:03
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 20596)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2022-02-02_02:11:03
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 20597)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2022-02-02_02:11:03
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 20595)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 4
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2729 and data parallel seed: 11
[26614] rank = 2, world_size = 4
[26612] rank = 0, world_size = 4
[26613] rank = 1, world_size = 4
[26615] rank = 3, world_size = 4
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0216, best latency: 0.0216 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0272, best latency: 0.0216 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0251, best latency: 0.0216 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0217, best latency: 0.0216 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0242, best latency: 0.0216 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0216, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0216, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0268, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0264, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0260, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0219, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0242, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0293, best latency: 0.0215 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0231, best latency: 0.0211 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.0221, best latency: 0.0211 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.0240, best latency: 0.0211 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.0239, best latency: 0.0210 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 170, current latency: 0.0242, best latency: 0.0210 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 180, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 190, current latency: 0.0263, best latency: 0.0210 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 200, current latency: 0.0211, best latency: 0.0210 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 210, current latency: 0.0246, best latency: 0.0210 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 220, current latency: 0.0203, best latency: 0.0203 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 230, current latency: 0.0244, best latency: 0.0202 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 240, current latency: 0.0204, best latency: 0.0202 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 250, current latency: 0.0214, best latency: 0.0202 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 260, current latency: 0.0274, best latency: 0.0202 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 270, current latency: 0.0227, best latency: 0.0202 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 280, current latency: 0.0239, best latency: 0.0198 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 290, current latency: 0.0251, best latency: 0.0194 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 300, current latency: 0.0194, best latency: 0.0194 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 310, current latency: 0.0194, best latency: 0.0194 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 320, current latency: 0.0196, best latency: 0.0194 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 330, current latency: 0.0194, best latency: 0.0194 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 340, current latency: 0.0219, best latency: 0.0189 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 350, current latency: 0.0194, best latency: 0.0189 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 360, current latency: 0.0185, best latency: 0.0181 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 370, current latency: 0.0244, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 380, current latency: 0.0224, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 390, current latency: 0.0232, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 400, current latency: 0.0181, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 410, current latency: 0.0196, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 420, current latency: 0.0190, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 430, current latency: 0.0252, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 440, current latency: 0.0228, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 450, current latency: 0.0189, best latency: 0.0180 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 460, current latency: 0.0173, best latency: 0.0173 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 470, current latency: 0.0181, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 480, current latency: 0.0205, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 490, current latency: 0.0245, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 500, current latency: 0.0240, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 510, current latency: 0.0219, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 520, current latency: 0.0233, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 530, current latency: 0.0186, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 540, current latency: 0.0174, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 550, current latency: 0.0220, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 560, current latency: 0.0176, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 570, current latency: 0.0195, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 580, current latency: 0.0197, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 590, current latency: 0.0175, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 600, current latency: 0.0175, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 610, current latency: 0.0209, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 620, current latency: 0.0192, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 630, current latency: 0.0174, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 640, current latency: 0.0261, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 650, current latency: 0.0171, best latency: 0.0170 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 660, current latency: 0.0197, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 670, current latency: 0.0213, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 680, current latency: 0.0237, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 690, current latency: 0.0169, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 700, current latency: 0.0169, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 710, current latency: 0.0192, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 720, current latency: 0.0193, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 730, current latency: 0.0173, best latency: 0.0169 baseline latency: 0.0216
no new strategies could be found
iteration: 740, current latency: 0.0168, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 750, current latency: 0.0181, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 760, current latency: 0.0168, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 770, current latency: 0.0219, best latency: 0.0158 baseline latency: 0.0216
iteration: 780, current latency: 0.0202, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
iteration: 790, current latency: 0.0163, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 800, current latency: 0.0234, best latency: 0.0158 baseline latency: 0.0216
iteration: 810, current latency: 0.0171, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 820, current latency: 0.0268, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 830, current latency: 0.0259, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 840, current latency: 0.0178, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 850, current latency: 0.0175, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 860, current latency: 0.0219, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
iteration: 870, current latency: 0.0226, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 880, current latency: 0.0183, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 890, current latency: 0.0229, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 900, current latency: 0.0286, best latency: 0.0158 baseline latency: 0.0216
no new strategies could be found
iteration: 910, current latency: 0.0162, best latency: 0.0155 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 920, current latency: 0.0176, best latency: 0.0154 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 930, current latency: 0.0205, best latency: 0.0153 baseline latency: 0.0216
iteration: 940, current latency: 0.0210, best latency: 0.0153 baseline latency: 0.0216
iteration: 950, current latency: 0.0167, best latency: 0.0153 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
iteration: 960, current latency: 0.0159, best latency: 0.0153 baseline latency: 0.0216
no new strategies could be found
iteration: 970, current latency: 0.0170, best latency: 0.0153 baseline latency: 0.0216
no new strategies could be found
iteration: 980, current latency: 0.0160, best latency: 0.0148 baseline latency: 0.0216
no new strategies could be found
iteration: 990, current latency: 0.0164, best latency: 0.0140 baseline latency: 0.0216
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
optimal latency: 0.014034903049468994, optimal strategy:
OrderedDict([('seq.0', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.1', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.2', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.3', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.4', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.5', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.6', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.7', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.8', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.9', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.10', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.11', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.12', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.13', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.14', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.15', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.16', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.17', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.18', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": true
    }
}), ('seq.19', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.20', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.21', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.22', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.23', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.24', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.25', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": true,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.26', {
    "DataParallel": {
        "gather_input": false,
        "split_output": true,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.27', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": true
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.28', {
    "DataParallel": {
        "gather_input": true,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.29', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.30', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": false
    }
}), ('seq.31', {
    "DataParallel": {
        "gather_input": false,
        "split_output": false,
        "data_parallel_input": false
    },
    "ModelParallel": {
        "row_linear": false,
        "input_is_parallel": false,
        "column_linear": false,
        "gather_output": true
    }
})])
[E ProcessGroupNCCL.cpp:587] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802886 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802896 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802904 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 0] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802875 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLREDUCE, Timeout(ms)=1800000) ran for 1802907 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 0] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLREDUCE, Timeout(ms)=1800000) ran for 1802870 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLREDUCE, Timeout(ms)=1800000) ran for 1802914 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:587] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLREDUCE, Timeout(ms)=1800000) ran for 1802927 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:341] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data. To avoid this inconsistency, we are taking the entire process down.
terminate called after throwing an instance of 'std::runtime_error'
  what():  [Rank 0] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802875 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:341] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data. To avoid this inconsistency, we are taking the entire process down.
[E ProcessGroupNCCL.cpp:341] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data. To avoid this inconsistency, we are taking the entire process down.
terminate called after throwing an instance of 'std::runtime_error'
  what():  [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802896 milliseconds before timing out.
terminate called after throwing an instance of 'std::runtime_error'
  what():  [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802904 milliseconds before timing out.
[E ProcessGroupNCCL.cpp:341] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data. To avoid this inconsistency, we are taking the entire process down.
terminate called after throwing an instance of 'std::runtime_error'
  what():  [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(OpType=ALLGATHER, Timeout(ms)=1800000) ran for 1802886 milliseconds before timing out.
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: -6) local_rank: 0 (pid: 26612) of binary: /opt/conda/bin/python
Traceback (most recent call last):
  File "/opt/conda/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.10.0', 'console_scripts', 'torchrun')())
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 719, in main
    run(args)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 710, in run
    elastic_launch(
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
===========================================================
mnist_mlp.py FAILED
-----------------------------------------------------------
Failures:
[1]:
  time      : 2022-02-02_03:24:59
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 1 (local_rank: 1)
  exitcode  : -6 (pid: 26613)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 26613
[2]:
  time      : 2022-02-02_03:24:59
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 2 (local_rank: 2)
  exitcode  : -6 (pid: 26614)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 26614
[3]:
  time      : 2022-02-02_03:24:59
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 3 (local_rank: 3)
  exitcode  : -6 (pid: 26615)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 26615
-----------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2022-02-02_03:24:59
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 0 (local_rank: 0)
  exitcode  : -6 (pid: 26612)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 26612
===========================================================
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 5
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2743 and data parallel seed: 25
[48544] rank = 4, world_size = 5
[48543] rank = 3, world_size = 5
[48542] rank = 2, world_size = 5
[48540] rank = 0, world_size = 5
[48541] rank = 1, world_size = 5
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0310, best latency: 0.0310 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0372, best latency: 0.0310 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0338, best latency: 0.0310 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0316, best latency: 0.0309 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0310, best latency: 0.0309 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0309, best latency: 0.0309 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0310, best latency: 0.0309 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0339, best latency: 0.0309 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0335, best latency: 0.0309 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0298, best latency: 0.0298 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0297, best latency: 0.0281 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0302, best latency: 0.0281 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0280, best latency: 0.0273 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0300, best latency: 0.0273 baseline latency: 0.0310
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
Traceback (most recent call last):
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)    init_processes(args)

  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
      File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 5AssertionError
: 1024 is not divisible by 5
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 5
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 5
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 5
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 48540) of binary: /opt/conda/bin/python
Traceback (most recent call last):
  File "/opt/conda/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.10.0', 'console_scripts', 'torchrun')())
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 719, in main
    run(args)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 710, in run
    elastic_launch(
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
mnist_mlp.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2022-02-02_03:32:05
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 48541)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2022-02-02_03:32:05
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 48542)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2022-02-02_03:32:05
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 48543)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[4]:
  time      : 2022-02-02_03:32:05
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 4 (local_rank: 4)
  exitcode  : 1 (pid: 48544)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2022-02-02_03:32:05
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 48540)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 6
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2750 and data parallel seed: 32
[51562] rank = 2, world_size = 6
[51560] rank = 0, world_size = 6
[51565] rank = 5, world_size = 6
[51561] rank = 1, world_size = 6
[51563] rank = 3, world_size = 6
[51564] rank = 4, world_size = 6
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0323, best latency: 0.0323 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0324, best latency: 0.0323 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0362, best latency: 0.0323 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0353, best latency: 0.0322 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0347, best latency: 0.0322 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0309, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0336, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0377, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0394, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0370, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0362, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0353, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0363, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0361, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.0343, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.0343, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.0364, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 170, current latency: 0.0395, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 180, current latency: 0.0411, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 190, current latency: 0.0333, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 200, current latency: 0.0386, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 210, current latency: 0.0347, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 220, current latency: 0.0375, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 230, current latency: 0.0326, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 240, current latency: 0.0368, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 250, current latency: 0.0350, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 260, current latency: 0.0381, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 270, current latency: 0.0356, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 280, current latency: 0.0370, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 290, current latency: 0.0345, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 300, current latency: 0.0356, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 310, current latency: 0.0335, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 320, current latency: 0.0341, best latency: 0.0307 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 330, current latency: 0.0307, best latency: 0.0293 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 340, current latency: 0.0331, best latency: 0.0293 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 350, current latency: 0.0313, best latency: 0.0293 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 360, current latency: 0.0288, best latency: 0.0284 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 370, current latency: 0.0352, best latency: 0.0279 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 380, current latency: 0.0279, best latency: 0.0278 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 390, current latency: 0.0337, best latency: 0.0278 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 400, current latency: 0.0320, best latency: 0.0278 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 410, current latency: 0.0282, best latency: 0.0278 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 420, current latency: 0.0279, best latency: 0.0278 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 430, current latency: 0.0332, best latency: 0.0278 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 440, current latency: 0.0268, best latency: 0.0255 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 450, current latency: 0.0312, best latency: 0.0255 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 460, current latency: 0.0327, best latency: 0.0255 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 470, current latency: 0.0308, best latency: 0.0255 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 480, current latency: 0.0306, best latency: 0.0255 baseline latency: 0.0323
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
AssertionError: 1024 is not divisible by 6
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 6
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 6
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 6
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 6
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 6
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 51560) of binary: /opt/conda/bin/python
Traceback (most recent call last):
  File "/opt/conda/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.10.0', 'console_scripts', 'torchrun')())
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 719, in main
    run(args)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 710, in run
    elastic_launch(
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
mnist_mlp.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2022-02-02_03:56:53
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 51561)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2022-02-02_03:56:53
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 51562)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2022-02-02_03:56:53
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 51563)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[4]:
  time      : 2022-02-02_03:56:53
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 4 (local_rank: 4)
  exitcode  : 1 (pid: 51564)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[5]:
  time      : 2022-02-02_03:56:53
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 5 (local_rank: 5)
  exitcode  : 1 (pid: 51565)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2022-02-02_03:56:53
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 51560)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 7
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2774 and data parallel seed: 56
[59782] rank = 4, world_size = 7
[59779] rank = 1, world_size = 7
[59778] rank = 0, world_size = 7
[59783] rank = 5, world_size = 7
[59784] rank = 6, world_size = 7
[59781] rank = 3, world_size = 7
[59780] rank = 2, world_size = 7
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0330, best latency: 0.0330 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 10, current latency: 0.0346, best latency: 0.0330 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 20, current latency: 0.0374, best latency: 0.0330 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 30, current latency: 0.0349, best latency: 0.0330 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 40, current latency: 0.0354, best latency: 0.0330 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 50, current latency: 0.0373, best latency: 0.0329 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 60, current latency: 0.0345, best latency: 0.0329 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 70, current latency: 0.0395, best latency: 0.0328 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 80, current latency: 0.0384, best latency: 0.0322 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 90, current latency: 0.0409, best latency: 0.0321 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 100, current latency: 0.0353, best latency: 0.0321 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 110, current latency: 0.0344, best latency: 0.0321 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 120, current latency: 0.0294, best latency: 0.0278 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 130, current latency: 0.0285, best latency: 0.0275 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 140, current latency: 0.0273, best latency: 0.0273 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 150, current latency: 0.0312, best latency: 0.0273 baseline latency: 0.0330
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
no new strategies could be found
iteration: 160, current latency: 0.0302, best latency: 0.0273 baseline latency: 0.0330
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
Traceback (most recent call last):
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 267, in <module>
    init_processes(args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 62, in init_processes
    best_ips, latency = train_and_test(local_rank, train_args)
  File "/workdisk/fairscale/dudu_tests/mlp/mnist_mlp.py", line 124, in train_and_test
    train_args.strategy, best_latency = Optimizer.find_optimal_strategy(temp_model, temp_optimizer, loss_model, sample,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 151, in find_optimal_strategy
    optimized_model = wrap_model(optimized_model, strategy=next_strategy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/Optimizer.py", line 44, in wrap_model
    model = custom_wrap.auto_wrap(model, auto_wrap_policy=my_auto_wrap_policy)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 403, in auto_wrap
    wrapped_module, remainder = ConfigAutoWrap.custom_recursive_wrap(module, auto_wrap_policy=auto_wrap_policy,
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 487, in custom_recursive_wrap
    wrapped_child, num_wrapped_params = ConfigAutoWrap.custom_recursive_wrap(
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 498, in custom_recursive_wrap
    return custom_wrap(module, name, **kwargs), num_params
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/custom_wrap.py", line 365, in custom_wrap
    return ConfigAutoWrap.wrapper_cls(module, module_name, **wrap_overrides)
  File "/workdisk/.local/lib/python3.9/site-packages/dudu_tests/layerwise_model_parallel.py", line 211, in __init__
    self.input_size_per_partition = divide_and_check_no_remainder(layer.in_features, world_size)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 36, in divide_and_check_no_remainder
    ensure_divisibility(numerator, denominator)
  File "/workdisk/.local/lib/python3.9/site-packages/fairscale/nn/model_parallel/utils.py", line 30, in ensure_divisibility
    assert numerator % denominator == 0, "{} is not divisible by {}".format(numerator, denominator)
AssertionError: 1024 is not divisible by 7
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 59778 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 59780 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 59782 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 59783 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 59779) of binary: /opt/conda/bin/python
Traceback (most recent call last):
  File "/opt/conda/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.10.0', 'console_scripts', 'torchrun')())
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 719, in main
    run(args)
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/run.py", line 710, in run
    elastic_launch(
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/conda/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
mnist_mlp.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2022-02-02_04:05:16
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 59781)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2022-02-02_04:05:16
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 6 (local_rank: 6)
  exitcode  : 1 (pid: 59784)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2022-02-02_04:05:16
  host      : dudu-set-0.pytorch.pelegdav.svc.cluster.local
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 59779)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Strong scaling
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
> initializing model parallel with size 8
> initializing ddp with size 1
> initializing pipeline with size 1
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2723 and data parallel seed: 5
[63582] rank = 4, world_size = 8
[63581] rank = 3, world_size = 8
[63578] rank = 0, world_size = 8
[63585] rank = 7, world_size = 8
[63584] rank = 6, world_size = 8
[63579] rank = 1, world_size = 8
[63583] rank = 5, world_size = 8
[63580] rank = 2, world_size = 8
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
finding optimal strategy
iteration: 0, current latency: 0.0319, best latency: 0.0319 baseline latency: 0.0319
no new strategies could be found
no new strategies could be found
