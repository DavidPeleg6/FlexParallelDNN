[646] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '32813', 'RANK': '0', 'WORLD_SIZE': '1'}
[646] rank = 0, world_size = 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 874.3799695968628s, BATCH = 32, AVG. THROUGHPUT = 686.2084934233719 samples/s,  AVG. LATENCY = 87.43790876865387
Test Loss: 4453853623.091200


Test Accuracy (Overall): 8.5600% (856/10000)
[646] rank = 0, world_size = 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 873.4078404903412s, BATCH = 32, AVG. THROUGHPUT = 686.9714511792889 samples/s,  AVG. LATENCY = 87.34070558547974
Test Loss: 150563864091.033600


Test Accuracy (Overall): 17.8700% (1787/10000)
Rank: 0, ips: 686.9714511792889, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[5535] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '39553', 'RANK': '0', 'WORLD_SIZE': '2'}
[5536] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '39553', 'RANK': '1', 'WORLD_SIZE': '2'}
[5535] rank = 0, world_size = 2
[5536] rank = 1, world_size = 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 508.0311653614044s, BATCH = 32, AVG. THROUGHPUT = 1180.4439039194958 samples/s,  AVG. LATENCY = 50.803044724464414
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 508.0329213142395s, BATCH = 32, AVG. THROUGHPUT = 1180.4404326890287 samples/s,  AVG. LATENCY = 50.803207588195804
Test Loss: 30026117872929.996094


Test Accuracy (Overall): 13.5300% (1353/10000)
[5536] rank = 1, world_size = 2
Test Loss: 30026117872929.996094


Test Accuracy (Overall): 13.5300% (1353/10000)
[5535] rank = 0, world_size = 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 507.7717914581299s, BATCH = 32, AVG. THROUGHPUT = 1181.0199245151896 samples/s,  AVG. LATENCY = 50.77709951400757
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 507.77261757850647s, BATCH = 32, AVG. THROUGHPUT = 1181.0178543831248 samples/s,  AVG. LATENCY = 50.777194952964784
Test Loss: 460829599727.616028


Test Accuracy (Overall): 11.6400% (1164/10000)
Test Loss: 460829599727.616028


Test Accuracy (Overall): 11.6400% (1164/10000)
Rank: 0, ips: 1181.0178543831248, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[7354] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43281', 'RANK': '1', 'WORLD_SIZE': '3'}
[7353] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43281', 'RANK': '0', 'WORLD_SIZE': '3'}
[7355] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43281', 'RANK': '2', 'WORLD_SIZE': '3'}
[7353] rank = 0, world_size = 3
[7355] rank = 2, world_size = 3
[7354] rank = 1, world_size = 3
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 373.20909810066223s, BATCH = 32, AVG. THROUGHPUT = 1607.7443892074657 samples/s,  AVG. LATENCY = 37.32080800533295
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 373.2137351036072s, BATCH = 32, AVG. THROUGHPUT = 1607.7230622337738 samples/s,  AVG. LATENCY = 37.32128283977509
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 373.2221403121948s, BATCH = 32, AVG. THROUGHPUT = 1607.6871542272968 samples/s,  AVG. LATENCY = 37.322114038467404
Test Loss: 526626023375949.000000


Test Accuracy (Overall): 12.8200% (1282/10000)
[7353] rank = 0, world_size = 3
Test Loss: 526626023375949.000000


Test Accuracy (Overall): 12.8200% (1282/10000)
[7354] rank = 1, world_size = 3
Test Loss: 526626023375949.000000


Test Accuracy (Overall): 12.8200% (1282/10000)
[7355] rank = 2, world_size = 3
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 371.9513952732086s, BATCH = 32, AVG. THROUGHPUT = 1613.1331940146451 samples/s,  AVG. LATENCY = 37.195062923431394
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 372.1427586078644s, BATCH = 32, AVG. THROUGHPUT = 1612.314619863666 samples/s,  AVG. LATENCY = 37.21421008110046
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 372.03888964653015s, BATCH = 32, AVG. THROUGHPUT = 1612.759683676545 samples/s,  AVG. LATENCY = 37.20380485057831
Test Loss: 263460091715597.093750


Test Accuracy (Overall): 15.7900% (1579/10000)
Rank: 0, ips: 1612.314619863666, 
Test Loss: 263460091715597.093750


Test Accuracy (Overall): 15.7900% (1579/10000)
Test Loss: 263460091715597.093750


Test Accuracy (Overall): 15.7900% (1579/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[9862] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '47367', 'RANK': '2', 'WORLD_SIZE': '4'}[9863] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '47367', 'RANK': '3', 'WORLD_SIZE': '4'}

[9860] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '47367', 'RANK': '0', 'WORLD_SIZE': '4'}
[9861] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '47367', 'RANK': '1', 'WORLD_SIZE': '4'}
[9860] rank = 0, world_size = 4
[9861] rank = 1, world_size = 4
[9862] rank = 2, world_size = 4
[9863] rank = 3, world_size = 4
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
initializing optimizer and loss  in global rank 1
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 3
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 277.1923723220825s, BATCH = 32, AVG. THROUGHPUT = 2161.3316517946673 samples/s,  AVG. LATENCY = 27.719140815734864
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 277.1936089992523s, BATCH = 32, AVG. THROUGHPUT = 2161.3267701717195 samples/s,  AVG. LATENCY = 27.719278168678283
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 277.20909094810486s, BATCH = 32, AVG. THROUGHPUT = 2161.1898379428726 samples/s,  AVG. LATENCY = 27.720825576782225
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 277.2091615200043s, BATCH = 32, AVG. THROUGHPUT = 2161.193456665258 samples/s,  AVG. LATENCY = 27.720831680297852
Test Loss: 242659781486890.187500


Test Accuracy (Overall): 22.1400% (2214/10000)
[9860] rank = 0, world_size = 4
Test Loss: 242659781486890.187500


Test Accuracy (Overall): 22.1400% (2214/10000)
[9863] rank = 3, world_size = 4
Test Loss: 242659781486890.187500


Test Accuracy (Overall): 22.1400% (2214/10000)
[9862] rank = 2, world_size = 4
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
Test Loss: 242659781486890.187500


Test Accuracy (Overall): 22.1400% (2214/10000)
[9861] rank = 1, world_size = 4
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 276.6099672317505s, BATCH = 32, AVG. THROUGHPUT = 2165.852128566607 samples/s,  AVG. LATENCY = 27.660931825637817
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 276.6103801727295s, BATCH = 32, AVG. THROUGHPUT = 2165.856970859608 samples/s,  AVG. LATENCY = 27.660973167419435
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 276.6173343658447s, BATCH = 32, AVG. THROUGHPUT = 2165.7952074723494 samples/s,  AVG. LATENCY = 27.66166353225708
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 277.51002955436707s, BATCH = 32, AVG. THROUGHPUT = 2158.9780523936765 samples/s,  AVG. LATENCY = 27.750945019721986
Test Loss: 227492798655155.406250


Test Accuracy (Overall): 19.0500% (1905/10000)
Test Loss: 227492798655155.406250


Test Accuracy (Overall): 19.0500% (1905/10000)
Test Loss: 227492798655155.406250


Test Accuracy (Overall): 19.0500% (1905/10000)
Test Loss: 227492798655155.406250


Test Accuracy (Overall): 19.0500% (1905/10000)
Rank: 0, ips: 2158.9780523936765, 
[57638] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60599', 'RANK': '0', 'WORLD_SIZE': '1'}
[57638] rank = 0, world_size = 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 744.5857625007629s, BATCH = 32, AVG. THROUGHPUT = 805.8492121654679 samples/s,  AVG. LATENCY = 74.4584797859192
Test Loss: 130093565044.326401


Test Accuracy (Overall): 16.1700% (1617/10000)
[57638] rank = 0, world_size = 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[14488] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44357', 'RANK': '0', 'WORLD_SIZE': '5'}
[14490] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44357', 'RANK': '2', 'WORLD_SIZE': '5'}
[14491] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44357', 'RANK': '3', 'WORLD_SIZE': '5'}
[14492] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44357', 'RANK': '4', 'WORLD_SIZE': '5'}
[14489] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44357', 'RANK': '1', 'WORLD_SIZE': '5'}
[14488] rank = 0, world_size = 5
[14489] rank = 1, world_size = 5
[14491] rank = 3, world_size = 5
[14490] rank = 2, world_size = 5
[14492] rank = 4, world_size = 5
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 4
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 235.3766746520996s, BATCH = 32, AVG. THROUGHPUT = 2549.508268575368 samples/s,  AVG. LATENCY = 23.537599039077758
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 235.38263201713562s, BATCH = 32, AVG. THROUGHPUT = 2549.422768789203 samples/s,  AVG. LATENCY = 23.538179087638856
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 235.38496685028076s, BATCH = 32, AVG. THROUGHPUT = 2549.4228160257103 samples/s,  AVG. LATENCY = 23.538422608375548
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 235.39067721366882s, BATCH = 32, AVG. THROUGHPUT = 2549.333466455137 samples/s,  AVG. LATENCY = 23.538982677459718
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 235.38864994049072s, BATCH = 32, AVG. THROUGHPUT = 2549.3608244031666 samples/s,  AVG. LATENCY = 23.53878457546234
Test Loss: 2864054419277113.000000


Test Accuracy (Overall): 11.4500% (1145/10000)
[14492] rank = 4, world_size = 5
Test Loss: 2864054419277113.000000


Test Accuracy (Overall): 11.4500% (1145/10000)
[14491] rank = 3, world_size = 5
Test Loss: 2864054419277113.000000


Test Accuracy (Overall): 11.4500% (1145/10000)
[14488] rank = 0, world_size = 5
Test Loss: 2864054419277113.000000


Test Accuracy (Overall): 11.4500% (1145/10000)
[14489] rank = 1, world_size = 5
Test Loss: 2864054419277113.000000


Test Accuracy (Overall): 11.4500% (1145/10000)
[14490] rank = 2, world_size = 5
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 4initializing optimizer and loss  in global rank 2

initializing optimizer and loss  in global rank 3
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 233.57910108566284s, BATCH = 32, AVG. THROUGHPUT = 2568.9256538065056 samples/s,  AVG. LATENCY = 23.357831716537476
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 233.58675622940063s, BATCH = 32, AVG. THROUGHPUT = 2568.845773922118 samples/s,  AVG. LATENCY = 23.3586168050766
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 233.59017896652222s, BATCH = 32, AVG. THROUGHPUT = 2568.808286477989 samples/s,  AVG. LATENCY = 23.358950281143187
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 233.60773730278015s, BATCH = 32, AVG. THROUGHPUT = 2568.613128391652 samples/s,  AVG. LATENCY = 23.360696864128112
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 233.60388493537903s, BATCH = 32, AVG. THROUGHPUT = 2568.6611735941988 samples/s,  AVG. LATENCY = 23.360316371917726
Test Loss: 965887140630521.500000


Test Accuracy (Overall): 8.6800% (868/10000)
Test Loss: 965887140630521.500000


Test Accuracy (Overall): 8.6800% (868/10000)
Test Loss: 965887140630521.500000


Test Accuracy (Overall): 8.6800% (868/10000)
Test Loss: 965887140630521.500000


Test Accuracy (Overall): 8.6800% (868/10000)
Test Loss: 965887140630521.500000


Test Accuracy (Overall): 8.6800% (868/10000)
Rank: 0, ips: 2568.613128391652, 
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 746.1687002182007s, BATCH = 32, AVG. THROUGHPUT = 804.1168676316566 samples/s,  AVG. LATENCY = 74.61677193641663
Test Loss: 61010274680.832001


Test Accuracy (Overall): 17.5700% (1757/10000)
Rank: 0, ips: 804.1168676316566, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[18488] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43407', 'RANK': '5', 'WORLD_SIZE': '6'}
[18487] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43407', 'RANK': '4', 'WORLD_SIZE': '6'}
[18486] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43407', 'RANK': '3', 'WORLD_SIZE': '6'}
[18484] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43407', 'RANK': '1', 'WORLD_SIZE': '6'}
[18483] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43407', 'RANK': '0', 'WORLD_SIZE': '6'}
[18485] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43407', 'RANK': '2', 'WORLD_SIZE': '6'}
[18483] rank = 0, world_size = 6
[18487] rank = 4, world_size = 6
[18488] rank = 5, world_size = 6
[18485] rank = 2, world_size = 6
[18486] rank = 3, world_size = 6
[18484] rank = 1, world_size = 6
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 198.220144033432s, BATCH = 32, AVG. THROUGHPUT = 3022.4835061263248 samples/s,  AVG. LATENCY = 19.821925497055055
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 198.22306060791016s, BATCH = 32, AVG. THROUGHPUT = 3022.424083482582 samples/s,  AVG. LATENCY = 19.822210955619813
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 198.2214982509613s, BATCH = 32, AVG. THROUGHPUT = 3022.451314927319 samples/s,  AVG. LATENCY = 19.82203435897827
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 198.22648239135742s, BATCH = 32, AVG. THROUGHPUT = 3022.384330603926 samples/s,  AVG. LATENCY = 19.822553873062134
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 198.22342562675476s, BATCH = 32, AVG. THROUGHPUT = 3022.4159482931395 samples/s,  AVG. LATENCY = 19.82223331928253
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 198.2215220928192s, BATCH = 32, AVG. THROUGHPUT = 3022.445275031988 samples/s,  AVG. LATENCY = 19.822066712379456
Test Loss: 370531522917800.375000


Test Accuracy (Overall): 15.1900% (1519/10000)
[18484] rank = 1, world_size = 6
Test Loss: 370531522917800.375000


Test Accuracy (Overall): 15.1900% (1519/10000)
[18485] rank = 2, world_size = 6
Test Loss: 370531522917800.375000


Test Accuracy (Overall): 15.1900% (1519/10000)
[18483] rank = 0, world_size = 6
Test Loss: 370531522917800.375000


Test Accuracy (Overall): 15.1900% (1519/10000)
[18487] rank = 4, world_size = 6
Test Loss: 370531522917800.375000


Test Accuracy (Overall): 15.1900% (1519/10000)
[18488] rank = 5, world_size = 6
Test Loss: 370531522917800.375000


Test Accuracy (Overall): 15.1900% (1519/10000)
[18486] rank = 3, world_size = 6
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 4
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 196.82616209983826s, BATCH = 32, AVG. THROUGHPUT = 3043.651234597554 samples/s,  AVG. LATENCY = 19.682536315917968
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 196.89788222312927s, BATCH = 32, AVG. THROUGHPUT = 3042.5261962815784 samples/s,  AVG. LATENCY = 19.68972988128662
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 196.89803552627563s, BATCH = 32, AVG. THROUGHPUT = 3042.532829592021 samples/s,  AVG. LATENCY = 19.689729690551758
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 196.83642625808716s, BATCH = 32, AVG. THROUGHPUT = 3043.492285817272 samples/s,  AVG. LATENCY = 19.683574819564818
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 196.90762305259705s, BATCH = 32, AVG. THROUGHPUT = 3042.3812563591264 samples/s,  AVG. LATENCY = 19.690697646141054
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 196.83746981620789s, BATCH = 32, AVG. THROUGHPUT = 3043.4810779521877 samples/s,  AVG. LATENCY = 19.68366906642914
Test Loss: 1512466324121452.500000


Test Accuracy (Overall): 17.1900% (1719/10000)
Test Loss: 1512466324121452.500000


Test Accuracy (Overall): 17.1900% (1719/10000)
Test Loss: 1512466324121452.500000


Test Accuracy (Overall): 17.1900% (1719/10000)
Rank: 0, ips: 3042.5261962815784, 
Test Loss: 1512466324121452.500000


Test Accuracy (Overall): 17.1900% (1719/10000)
Test Loss: 1512466324121452.500000


Test Accuracy (Overall): 17.1900% (1719/10000)
Test Loss: 1512466324121452.500000


Test Accuracy (Overall): 17.1900% (1719/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[23225] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '3', 'WORLD_SIZE': '7'}
[23228] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '6', 'WORLD_SIZE': '7'}[23227] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '5', 'WORLD_SIZE': '7'}

[23223] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '1', 'WORLD_SIZE': '7'}
[23222] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '0', 'WORLD_SIZE': '7'}
[23226] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '4', 'WORLD_SIZE': '7'}
[23224] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '54695', 'RANK': '2', 'WORLD_SIZE': '7'}
[23222] rank = 0, world_size = 7
[23228] rank = 6, world_size = 7
[23226] rank = 4, world_size = 7
[23223] rank = 1, world_size = 7
[23224] rank = 2, world_size = 7
[23227] rank = 5, world_size = 7
[23225] rank = 3, world_size = 7
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 5
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 173.1623466014862s, BATCH = 32, AVG. THROUGHPUT = 3454.9761234421576 samples/s,  AVG. LATENCY = 17.316150379180907
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 173.16184496879578s, BATCH = 32, AVG. THROUGHPUT = 3455.0018479348096 samples/s,  AVG. LATENCY = 17.316113805770875
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 173.16440296173096s, BATCH = 32, AVG. THROUGHPUT = 3454.939156810606 samples/s,  AVG. LATENCY = 17.316336965560915
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 173.1690332889557s, BATCH = 32, AVG. THROUGHPUT = 3454.8078973478528 samples/s,  AVG. LATENCY = 17.31681411266327
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 173.1688792705536s, BATCH = 32, AVG. THROUGHPUT = 3454.8257066718097 samples/s,  AVG. LATENCY = 17.316777110099792
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 173.18653416633606s, BATCH = 32, AVG. THROUGHPUT = 3454.472541187818 samples/s,  AVG. LATENCY = 17.3185405254364
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 173.18700766563416s, BATCH = 32, AVG. THROUGHPUT = 3454.4765446027036 samples/s,  AVG. LATENCY = 17.318620085716248
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23222] rank = 0, world_size = 7
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23228] rank = 6, world_size = 7
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23226] rank = 4, world_size = 7
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23223] rank = 1, world_size = 7
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23227] rank = 5, world_size = 7
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23225] rank = 3, world_size = 7
Test Loss: 74511236175233.031250


Test Accuracy (Overall): 12.8100% (1281/10000)
[23224] rank = 2, world_size = 7
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 5initializing optimizer and loss  in global rank 3

initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[58999] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '52159', 'RANK': '0', 'WORLD_SIZE': '2'}
[59000] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '52159', 'RANK': '1', 'WORLD_SIZE': '2'}
[58999] rank = 0, world_size = 2
[59000] rank = 1, world_size = 2
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 172.53490495681763s, BATCH = 32, AVG. THROUGHPUT = 3466.897241347793 samples/s,  AVG. LATENCY = 17.25342538356781
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 172.26013278961182s, BATCH = 32, AVG. THROUGHPUT = 3472.296204126834 samples/s,  AVG. LATENCY = 17.225951027870178
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 172.26167941093445s, BATCH = 32, AVG. THROUGHPUT = 3472.264518098218 samples/s,  AVG. LATENCY = 17.22611975669861
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 172.26185393333435s, BATCH = 32, AVG. THROUGHPUT = 3472.2677476292133 samples/s,  AVG. LATENCY = 17.226092052459716
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 172.26364994049072s, BATCH = 32, AVG. THROUGHPUT = 3472.259903979226 samples/s,  AVG. LATENCY = 17.226287412643433
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 172.2681725025177s, BATCH = 32, AVG. THROUGHPUT = 3472.1547302038744 samples/s,  AVG. LATENCY = 17.22676043510437
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 172.4000539779663s, BATCH = 32, AVG. THROUGHPUT = 3469.5161232113796 samples/s,  AVG. LATENCY = 17.239942741394042
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
Rank: 0, ips: 3466.897241347793, 
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
Test Loss: 3576933085483735.500000


Test Accuracy (Overall): 13.5900% (1359/10000)
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 452.90261578559875s, BATCH = 32, AVG. THROUGHPUT = 1324.1198207657194 samples/s,  AVG. LATENCY = 45.29013390541077
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 452.9055805206299s, BATCH = 32, AVG. THROUGHPUT = 1324.1129304705369 samples/s,  AVG. LATENCY = 45.2904556274414
Test Loss: 41348216188305.406250


Test Accuracy (Overall): 9.8400% (984/10000)
[59000] rank = 1, world_size = 2
Test Loss: 41348216188305.406250


Test Accuracy (Overall): 9.8400% (984/10000)
[58999] rank = 0, world_size = 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 453.2423152923584s, BATCH = 32, AVG. THROUGHPUT = 1323.1203879645934 samples/s,  AVG. LATENCY = 45.32412052154541
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 453.2519037723541s, BATCH = 32, AVG. THROUGHPUT = 1323.0899028885692 samples/s,  AVG. LATENCY = 45.325099444389345
Test Loss: 66323448068466.281250


Test Accuracy (Overall): 18.9600% (1896/10000)
Test Loss: 66323448068466.281250


Test Accuracy (Overall): 18.9600% (1896/10000)
Rank: 0, ips: 1323.1203879645934, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[28706] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '1', 'WORLD_SIZE': '8'}
[28707] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '2', 'WORLD_SIZE': '8'}
[28709] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '4', 'WORLD_SIZE': '8'}
[28712] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '7', 'WORLD_SIZE': '8'}
[28711] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '6', 'WORLD_SIZE': '8'}
[28710] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '5', 'WORLD_SIZE': '8'}
[28708] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '3', 'WORLD_SIZE': '8'}
[28705] Initializing process group with: {'MASTER_ADDR': 'dudu-set-0.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33577', 'RANK': '0', 'WORLD_SIZE': '8'}
[28707] rank = 2, world_size = 8
[28711] rank = 6, world_size = 8
[28705] rank = 0, world_size = 8
[28710] rank = 5, world_size = 8
[28709] rank = 4, world_size = 8[28712] rank = 7, world_size = 8

[28706] rank = 1, world_size = 8
[28708] rank = 3, world_size = 8
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 7
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 5initializing optimizer and loss  in global rank 2

initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 153.27390003204346s, BATCH = 32, AVG. THROUGHPUT = 3910.081811716923 samples/s,  AVG. LATENCY = 15.32731728553772
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 153.27269315719604s, BATCH = 32, AVG. THROUGHPUT = 3910.1010481536637 samples/s,  AVG. LATENCY = 15.327185940742492
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 153.27405953407288s, BATCH = 32, AVG. THROUGHPUT = 3910.072109902279 samples/s,  AVG. LATENCY = 15.327318096160889
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 153.27715611457825s, BATCH = 32, AVG. THROUGHPUT = 3910.0150696718547 samples/s,  AVG. LATENCY = 15.327620339393615
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 153.28299713134766s, BATCH = 32, AVG. THROUGHPUT = 3909.8082177076844 samples/s,  AVG. LATENCY = 15.328199005126953
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 153.28591322898865s, BATCH = 32, AVG. THROUGHPUT = 3909.790634124275 samples/s,  AVG. LATENCY = 15.32850422859192
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 153.28191876411438s, BATCH = 32, AVG. THROUGHPUT = 3909.8302061128843 samples/s,  AVG. LATENCY = 15.328113245964051
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 153.28684902191162s, BATCH = 32, AVG. THROUGHPUT = 3909.7515656641217 samples/s,  AVG. LATENCY = 15.32859148979187
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
[28712] rank = 7, world_size = 8
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
[28708] rank = 3, world_size = 8
[28710] rank = 5, world_size = 8
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
[28706] rank = 1, world_size = 8
[28705] rank = 0, world_size = 8
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
[28707] rank = 2, world_size = 8
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
[28711] rank = 6, world_size = 8
Test Loss: 2061798305053225.750000


Test Accuracy (Overall): 19.5700% (1957/10000)
[28709] rank = 4, world_size = 8
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 7
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 4
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 152.23093843460083s, BATCH = 32, AVG. THROUGHPUT = 3935.4144860492 samples/s,  AVG. LATENCY = 15.22302770614624
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 152.10897874832153s, BATCH = 32, AVG. THROUGHPUT = 3938.6009107596574 samples/s,  AVG. LATENCY = 15.210829043388367
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 152.22729063034058s, BATCH = 32, AVG. THROUGHPUT = 3935.454777244321 samples/s,  AVG. LATENCY = 15.22267792224884
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 152.24389457702637s, BATCH = 32, AVG. THROUGHPUT = 3935.0589183828006 samples/s,  AVG. LATENCY = 15.224329304695129
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 152.22837662696838s, BATCH = 32, AVG. THROUGHPUT = 3935.4840500029504 samples/s,  AVG. LATENCY = 15.222786140441894
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 152.1193277835846s, BATCH = 32, AVG. THROUGHPUT = 3938.3102033737478 samples/s,  AVG. LATENCY = 15.211876821517944
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 152.12086486816406s, BATCH = 32, AVG. THROUGHPUT = 3938.260145161763 samples/s,  AVG. LATENCY = 15.212012028694152
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 152.12824487686157s, BATCH = 32, AVG. THROUGHPUT = 3938.063397462516 samples/s,  AVG. LATENCY = 15.21274654865265
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Rank: 0, ips: 3935.0589183828006, 
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
Test Loss: 1512557348222350.250000


Test Accuracy (Overall): 12.3100% (1231/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[61154] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '38835', 'RANK': '1', 'WORLD_SIZE': '3'}
[61155] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '38835', 'RANK': '2', 'WORLD_SIZE': '3'}
[61153] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '38835', 'RANK': '0', 'WORLD_SIZE': '3'}
[61153] rank = 0, world_size = 3
[61154] rank = 1, world_size = 3
[61155] rank = 2, world_size = 3
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 324.95240354537964s, BATCH = 32, AVG. THROUGHPUT = 1846.656345740013 samples/s,  AVG. LATENCY = 32.49514935016632
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 324.95351457595825s, BATCH = 32, AVG. THROUGHPUT = 1846.6593938023732 samples/s,  AVG. LATENCY = 32.4952428817749
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 324.9552426338196s, BATCH = 32, AVG. THROUGHPUT = 1846.6434750596686 samples/s,  AVG. LATENCY = 32.49543232917786
Test Loss: 120081699749599.640625


Test Accuracy (Overall): 10.9800% (1098/10000)
[61155] rank = 2, world_size = 3
Test Loss: 120081699749599.640625


Test Accuracy (Overall): 10.9800% (1098/10000)
[61154] rank = 1, world_size = 3
Test Loss: 120081699749599.640625


Test Accuracy (Overall): 10.9800% (1098/10000)
[61153] rank = 0, world_size = 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 323.8436267375946s, BATCH = 32, AVG. THROUGHPUT = 1852.8105788265461 samples/s,  AVG. LATENCY = 32.384275674819946
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 323.8510956764221s, BATCH = 32, AVG. THROUGHPUT = 1852.7706471558836 samples/s,  AVG. LATENCY = 32.38502037525177
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 323.8649072647095s, BATCH = 32, AVG. THROUGHPUT = 1852.686213275881 samples/s,  AVG. LATENCY = 32.38640475273132
Test Loss: 218720504825197.375000


Test Accuracy (Overall): 14.8900% (1489/10000)
Test Loss: 218720504825197.375000


Test Accuracy (Overall): 14.8900% (1489/10000)
Test Loss: 218720504825197.375000


Test Accuracy (Overall): 14.8900% (1489/10000)
Rank: 0, ips: 1852.686213275881, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[64143] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '49109', 'RANK': '3', 'WORLD_SIZE': '4'}
[64140] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '49109', 'RANK': '0', 'WORLD_SIZE': '4'}
[64142] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '49109', 'RANK': '2', 'WORLD_SIZE': '4'}
[64141] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '49109', 'RANK': '1', 'WORLD_SIZE': '4'}
[64140] rank = 0, world_size = 4
[64143] rank = 3, world_size = 4
[64142] rank = 2, world_size = 4
[64141] rank = 1, world_size = 4
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
initializing optimizer and loss  in global rank 1
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 250.18485617637634s, BATCH = 32, AVG. THROUGHPUT = 2394.738221387243 samples/s,  AVG. LATENCY = 25.01839165687561
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 250.1875879764557s, BATCH = 32, AVG. THROUGHPUT = 2394.71754763596 samples/s,  AVG. LATENCY = 25.018670797348022
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 250.1897451877594s, BATCH = 32, AVG. THROUGHPUT = 2394.689531554974 samples/s,  AVG. LATENCY = 25.018845629692077
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 250.19003534317017s, BATCH = 32, AVG. THROUGHPUT = 2394.6926277276434 samples/s,  AVG. LATENCY = 25.018911504745482
Test Loss: 764364337451945.125000


Test Accuracy (Overall): 15.0500% (1505/10000)
[64140] rank = 0, world_size = 4
Test Loss: 764364337451945.125000


Test Accuracy (Overall): 15.0500% (1505/10000)
[64142] rank = 2, world_size = 4
Test Loss: 764364337451945.125000


Test Accuracy (Overall): 15.0500% (1505/10000)
[64141] rank = 1, world_size = 4
Test Loss: 764364337451945.125000


Test Accuracy (Overall): 15.0500% (1505/10000)
[64143] rank = 3, world_size = 4
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 251.06472659111023s, BATCH = 32, AVG. THROUGHPUT = 2386.1448598923953 samples/s,  AVG. LATENCY = 25.106404542922974
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 251.14190435409546s, BATCH = 32, AVG. THROUGHPUT = 2385.4239774713833 samples/s,  AVG. LATENCY = 25.114125537872315
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 250.73378896713257s, BATCH = 32, AVG. THROUGHPUT = 2389.2408520741483 samples/s,  AVG. LATENCY = 25.07327823638916
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 251.08222365379333s, BATCH = 32, AVG. THROUGHPUT = 2385.9714621661506 samples/s,  AVG. LATENCY = 25.108141350746155
Test Loss: 162774580856252.000000


Test Accuracy (Overall): 18.5500% (1855/10000)
Test Loss: 162774580856252.000000


Test Accuracy (Overall): 18.5500% (1855/10000)
Rank: 0, ips: 2385.4239774713833, 
Test Loss: 162774580856252.000000


Test Accuracy (Overall): 18.5500% (1855/10000)
Test Loss: 162774580856252.000000


Test Accuracy (Overall): 18.5500% (1855/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[68126] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '53279', 'RANK': '2', 'WORLD_SIZE': '5'}
[68125] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '53279', 'RANK': '1', 'WORLD_SIZE': '5'}
[68127] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '53279', 'RANK': '3', 'WORLD_SIZE': '5'}
[68124] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '53279', 'RANK': '0', 'WORLD_SIZE': '5'}
[68128] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '53279', 'RANK': '4', 'WORLD_SIZE': '5'}
[68124] rank = 0, world_size = 5
[68128] rank = 4, world_size = 5
[68127] rank = 3, world_size = 5
[68125] rank = 1, world_size = 5
[68126] rank = 2, world_size = 5
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
initializing optimizer and loss  in global rank 4
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 2
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 216.69970083236694s, BATCH = 32, AVG. THROUGHPUT = 2770.389485052175 samples/s,  AVG. LATENCY = 21.6698899269104
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 216.7017059326172s, BATCH = 32, AVG. THROUGHPUT = 2770.361659255492 samples/s,  AVG. LATENCY = 21.67009084224701
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 216.70925903320312s, BATCH = 32, AVG. THROUGHPUT = 2770.295958285329 samples/s,  AVG. LATENCY = 21.670825839042664
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 216.71860599517822s, BATCH = 32, AVG. THROUGHPUT = 2770.1378104528476 samples/s,  AVG. LATENCY = 21.67177426815033
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 216.7190456390381s, BATCH = 32, AVG. THROUGHPUT = 2770.135792798902 samples/s,  AVG. LATENCY = 21.671796488761903
Test Loss: 1111131523282632.750000


Test Accuracy (Overall): 19.3100% (1931/10000)
[68126] rank = 2, world_size = 5
Test Loss: 1111131523282632.750000


Test Accuracy (Overall): 19.3100% (1931/10000)
[68127] rank = 3, world_size = 5
Test Loss: 1111131523282632.750000


Test Accuracy (Overall): 19.3100% (1931/10000)
[68124] rank = 0, world_size = 5
Test Loss: 1111131523282632.750000


Test Accuracy (Overall): 19.3100% (1931/10000)
[68125] rank = 1, world_size = 5
Test Loss: 1111131523282632.750000


Test Accuracy (Overall): 19.3100% (1931/10000)
[68128] rank = 4, world_size = 5
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 4
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 214.79791283607483s, BATCH = 32, AVG. THROUGHPUT = 2793.3770401896427 samples/s,  AVG. LATENCY = 21.479709959030153
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 214.7452154159546s, BATCH = 32, AVG. THROUGHPUT = 2794.059625018533 samples/s,  AVG. LATENCY = 21.474447345733644
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 214.83296847343445s, BATCH = 32, AVG. THROUGHPUT = 2792.9192959688194 samples/s,  AVG. LATENCY = 21.483225417137145
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 214.81613087654114s, BATCH = 32, AVG. THROUGHPUT = 2793.1319178563085 samples/s,  AVG. LATENCY = 21.48153085708618
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 214.81814622879028s, BATCH = 32, AVG. THROUGHPUT = 2793.1096216538667 samples/s,  AVG. LATENCY = 21.481729459762573
Test Loss: 1100103837945744.625000


Test Accuracy (Overall): 17.2000% (1720/10000)
Test Loss: 1100103837945744.625000


Test Accuracy (Overall): 17.2000% (1720/10000)
Test Loss: 1100103837945744.625000


Test Accuracy (Overall): 17.2000% (1720/10000)
Test Loss: 1100103837945744.625000


Test Accuracy (Overall): 17.2000% (1720/10000)
Test Loss: 1100103837945744.625000


Test Accuracy (Overall): 17.2000% (1720/10000)
Rank: 0, ips: 2792.9192959688194, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[72891] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43797', 'RANK': '2', 'WORLD_SIZE': '6'}
[72889] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43797', 'RANK': '0', 'WORLD_SIZE': '6'}
[72893] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43797', 'RANK': '4', 'WORLD_SIZE': '6'}
[72894] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43797', 'RANK': '5', 'WORLD_SIZE': '6'}
[72890] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43797', 'RANK': '1', 'WORLD_SIZE': '6'}
[72892] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '43797', 'RANK': '3', 'WORLD_SIZE': '6'}
[72889] rank = 0, world_size = 6
[72893] rank = 4, world_size = 6
[72892] rank = 3, world_size = 6
[72894] rank = 5, world_size = 6
[72890] rank = 1, world_size = 6
[72891] rank = 2, world_size = 6
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 183.21472930908203s, BATCH = 32, AVG. THROUGHPUT = 3270.6642948861872 samples/s,  AVG. LATENCY = 18.32137265205383
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 183.2182857990265s, BATCH = 32, AVG. THROUGHPUT = 3270.610589559471 samples/s,  AVG. LATENCY = 18.32171537876129
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 183.22662019729614s, BATCH = 32, AVG. THROUGHPUT = 3270.4889894909734 samples/s,  AVG. LATENCY = 18.32255530357361
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 183.22778797149658s, BATCH = 32, AVG. THROUGHPUT = 3270.4631276357004 samples/s,  AVG. LATENCY = 18.322649598121643
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 183.2320580482483s, BATCH = 32, AVG. THROUGHPUT = 3270.354444780507 samples/s,  AVG. LATENCY = 18.323106169700623
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 183.23648929595947s, BATCH = 32, AVG. THROUGHPUT = 3270.301794818467 samples/s,  AVG. LATENCY = 18.32353894710541
Test Loss: 484627266107395.250000


Test Accuracy (Overall): 13.1800% (1318/10000)
[72890] rank = 1, world_size = 6
Test Loss: 484627266107395.250000


Test Accuracy (Overall): 13.1800% (1318/10000)
[72891] rank = 2, world_size = 6
Test Loss: 484627266107395.250000


Test Accuracy (Overall): 13.1800% (1318/10000)
[72889] rank = 0, world_size = 6
Test Loss: 484627266107395.250000


Test Accuracy (Overall): 13.1800% (1318/10000)
[72893] rank = 4, world_size = 6
Test Loss: 484627266107395.250000


Test Accuracy (Overall): 13.1800% (1318/10000)
[72894] rank = 5, world_size = 6
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2initializing optimizer and loss  in global rank 0

total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
Test Loss: 484627266107395.250000


Test Accuracy (Overall): 13.1800% (1318/10000)
[72892] rank = 3, world_size = 6
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 4
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 182.7926380634308s, BATCH = 32, AVG. THROUGHPUT = 3277.2890121615446 samples/s,  AVG. LATENCY = 18.279187870025634
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 183.35316610336304s, BATCH = 32, AVG. THROUGHPUT = 3267.433018007238 samples/s,  AVG. LATENCY = 18.335216569900513
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 182.80028629302979s, BATCH = 32, AVG. THROUGHPUT = 3277.144228694919 samples/s,  AVG. LATENCY = 18.27992253303528
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 183.3552212715149s, BATCH = 32, AVG. THROUGHPUT = 3267.391412585284 samples/s,  AVG. LATENCY = 18.33546586036682
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 183.3605604171753s, BATCH = 32, AVG. THROUGHPUT = 3267.31456587637 samples/s,  AVG. LATENCY = 18.335969924926758
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 182.81307220458984s, BATCH = 32, AVG. THROUGHPUT = 3276.9189581581495 samples/s,  AVG. LATENCY = 18.281249618530275
Test Loss: 646182878309882.250000


Test Accuracy (Overall): 11.0000% (1100/10000)
Rank: 0, ips: 3267.433018007238, 
Test Loss: 646182878309882.250000


Test Accuracy (Overall): 11.0000% (1100/10000)
Test Loss: 646182878309882.250000


Test Accuracy (Overall): 11.0000% (1100/10000)
Test Loss: 646182878309882.250000


Test Accuracy (Overall): 11.0000% (1100/10000)
Test Loss: 646182878309882.250000


Test Accuracy (Overall): 11.0000% (1100/10000)
Test Loss: 646182878309882.250000


Test Accuracy (Overall): 11.0000% (1100/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[78546] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '6', 'WORLD_SIZE': '7'}
[78544] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '4', 'WORLD_SIZE': '7'}
[78545] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '5', 'WORLD_SIZE': '7'}
[78540] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '0', 'WORLD_SIZE': '7'}
[78543] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '3', 'WORLD_SIZE': '7'}
[78542] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '2', 'WORLD_SIZE': '7'}
[78541] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '45521', 'RANK': '1', 'WORLD_SIZE': '7'}
[78540] rank = 0, world_size = 7
[78541] rank = 1, world_size = 7
[78544] rank = 4, world_size = 7
[78545] rank = 5, world_size = 7
[78542] rank = 2, world_size = 7
[78546] rank = 6, world_size = 7
[78543] rank = 3, world_size = 7
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 3
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 160.65130615234375s, BATCH = 32, AVG. THROUGHPUT = 3725.6420874542905 samples/s,  AVG. LATENCY = 16.065044116973876
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 160.6478133201599s, BATCH = 32, AVG. THROUGHPUT = 3725.656022450808 samples/s,  AVG. LATENCY = 16.064669823646547
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 160.64965915679932s, BATCH = 32, AVG. THROUGHPUT = 3725.597156478735 samples/s,  AVG. LATENCY = 16.064852786064147
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 160.65188264846802s, BATCH = 32, AVG. THROUGHPUT = 3725.629912285757 samples/s,  AVG. LATENCY = 16.065081191062927
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 160.65488815307617s, BATCH = 32, AVG. THROUGHPUT = 3725.5457819365524 samples/s,  AVG. LATENCY = 16.06540675163269
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 160.65598154067993s, BATCH = 32, AVG. THROUGHPUT = 3725.4892169462864 samples/s,  AVG. LATENCY = 16.065506434440614
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 160.67000269889832s, BATCH = 32, AVG. THROUGHPUT = 3725.177016282129 samples/s,  AVG. LATENCY = 16.0669269323349
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78541] rank = 1, world_size = 7
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78545] rank = 5, world_size = 7
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78544] rank = 4, world_size = 7
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78546] rank = 6, world_size = 7
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78543] rank = 3, world_size = 7
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78540] rank = 0, world_size = 7
Test Loss: 3857183302018819.500000


Test Accuracy (Overall): 13.3000% (1330/10000)
[78542] rank = 2, world_size = 7
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 6
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 159.34937644004822s, BATCH = 32, AVG. THROUGHPUT = 3753.474458481808 samples/s,  AVG. LATENCY = 15.934875178337098
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 159.35051846504211s, BATCH = 32, AVG. THROUGHPUT = 3753.413399801171 samples/s,  AVG. LATENCY = 15.934984040260314
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 159.35641837120056s, BATCH = 32, AVG. THROUGHPUT = 3753.2936600328476 samples/s,  AVG. LATENCY = 15.935590720176696
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 159.36772680282593s, BATCH = 32, AVG. THROUGHPUT = 3753.0053856661316 samples/s,  AVG. LATENCY = 15.936701703071595
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 159.36044692993164s, BATCH = 32, AVG. THROUGHPUT = 3753.1973634953256 samples/s,  AVG. LATENCY = 15.935972809791565
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 159.36948037147522s, BATCH = 32, AVG. THROUGHPUT = 3752.982319178968 samples/s,  AVG. LATENCY = 15.936860132217408
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 159.38260293006897s, BATCH = 32, AVG. THROUGHPUT = 3752.6857079034307 samples/s,  AVG. LATENCY = 15.938193655014038
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
Rank: 0, ips: 3753.0053856661316, 
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
Test Loss: 210376827816607392.000000


Test Accuracy (Overall): 8.4200% (842/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[85083] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '4', 'WORLD_SIZE': '8'}[85081] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '2', 'WORLD_SIZE': '8'}

[85079] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '0', 'WORLD_SIZE': '8'}
[85080] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '1', 'WORLD_SIZE': '8'}
[85082] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '3', 'WORLD_SIZE': '8'}
[85086] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '7', 'WORLD_SIZE': '8'}
[85085] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '6', 'WORLD_SIZE': '8'}
[85084] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '33799', 'RANK': '5', 'WORLD_SIZE': '8'}
[85079] rank = 0, world_size = 8
[85084] rank = 5, world_size = 8
[85082] rank = 3, world_size = 8
[85085] rank = 6, world_size = 8
[85080] rank = 1, world_size = 8
[85081] rank = 2, world_size = 8
[85083] rank = 4, world_size = 8
[85086] rank = 7, world_size = 8
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 7
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 142.36502933502197s, BATCH = 32, AVG. THROUGHPUT = 4211.559340134862 samples/s,  AVG. LATENCY = 14.236385798454284
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 142.3667814731598s, BATCH = 32, AVG. THROUGHPUT = 4211.515861155434 samples/s,  AVG. LATENCY = 14.236603283882141
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 142.37229895591736s, BATCH = 32, AVG. THROUGHPUT = 4211.353838625204 samples/s,  AVG. LATENCY = 14.237146258354187
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 142.36898970603943s, BATCH = 32, AVG. THROUGHPUT = 4211.451309106436 samples/s,  AVG. LATENCY = 14.23680317401886
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 142.3742880821228s, BATCH = 32, AVG. THROUGHPUT = 4211.2285845930355 samples/s,  AVG. LATENCY = 14.237321043014527
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 142.3834364414215s, BATCH = 32, AVG. THROUGHPUT = 4210.997343940864 samples/s,  AVG. LATENCY = 14.238268756866455
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 142.4061164855957s, BATCH = 32, AVG. THROUGHPUT = 4210.315130929766 samples/s,  AVG. LATENCY = 14.240490174293518
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 142.41951894760132s, BATCH = 32, AVG. THROUGHPUT = 4209.834143698483 samples/s,  AVG. LATENCY = 14.241858220100402
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85083] rank = 4, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85084] rank = 5, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85079] rank = 0, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85081] rank = 2, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85080] rank = 1, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85086] rank = 7, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85085] rank = 6, world_size = 8
Test Loss: 2739391073230835.000000


Test Accuracy (Overall): 9.8200% (982/10000)
[85082] rank = 3, world_size = 8
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 7
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 5
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 141.15577578544617s, BATCH = 32, AVG. THROUGHPUT = 4243.9417716891085 samples/s,  AVG. LATENCY = 14.115514373779297
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 141.25676465034485s, BATCH = 32, AVG. THROUGHPUT = 4240.936591307514 samples/s,  AVG. LATENCY = 14.12561776638031
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 141.25962018966675s, BATCH = 32, AVG. THROUGHPUT = 4240.830928074398 samples/s,  AVG. LATENCY = 14.125892043113708
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 141.16190266609192s, BATCH = 32, AVG. THROUGHPUT = 4243.753598816811 samples/s,  AVG. LATENCY = 14.116077637672424
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 141.16936707496643s, BATCH = 32, AVG. THROUGHPUT = 4243.543013076609 samples/s,  AVG. LATENCY = 14.11685769557953
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 141.17029237747192s, BATCH = 32, AVG. THROUGHPUT = 4243.500469379936 samples/s,  AVG. LATENCY = 14.116975593566895
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 141.27631735801697s, BATCH = 32, AVG. THROUGHPUT = 4240.323637911482 samples/s,  AVG. LATENCY = 14.127542948722839
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 141.1842863559723s, BATCH = 32, AVG. THROUGHPUT = 4243.076055104586 samples/s,  AVG. LATENCY = 14.118363881111145
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Rank: 0, ips: 4240.323637911482, 
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
Test Loss: 2639043598202018.000000


Test Accuracy (Overall): 12.4600% (1246/10000)
[339] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '37525', 'RANK': '0', 'WORLD_SIZE': '1'}
[339] rank = 0, world_size = 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 875.3776485919952s, BATCH = 32, AVG. THROUGHPUT = 685.4282878071152 samples/s,  AVG. LATENCY = 87.53769011497498
Test Loss: 22665840738.304001


Test Accuracy (Overall): 11.4500% (1145/10000)
[339] rank = 0, world_size = 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 1, ELAPSED TIME = 877.4162375926971s, BATCH = 32, AVG. THROUGHPUT = 683.8379456721265 samples/s,  AVG. LATENCY = 87.74155135154724
Test Loss: 56878584954.879997


Test Accuracy (Overall): 11.7000% (1170/10000)
Rank: 0, ips: 683.8379456721265, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[1485] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '56007', 'RANK': '1', 'WORLD_SIZE': '2'}
[1484] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '56007', 'RANK': '0', 'WORLD_SIZE': '2'}
[1484] rank = 0, world_size = 2
[1485] rank = 1, world_size = 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 510.32309913635254s, BATCH = 32, AVG. THROUGHPUT = 1175.1464314593975 samples/s,  AVG. LATENCY = 51.03222103118897
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 510.32499408721924s, BATCH = 32, AVG. THROUGHPUT = 1175.1424084431776 samples/s,  AVG. LATENCY = 51.0324126958847
Test Loss: 17306730616166.810547


Test Accuracy (Overall): 10.3100% (1031/10000)
[1485] rank = 1, world_size = 2
Test Loss: 17306730616166.810547


Test Accuracy (Overall): 10.3100% (1031/10000)
[1484] rank = 0, world_size = 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 2, ELAPSED TIME = 508.0550682544708s, BATCH = 32, AVG. THROUGHPUT = 1180.3640127281199 samples/s,  AVG. LATENCY = 50.8054440498352
RANK = 0, GPU AMOUNT = 2, ELAPSED TIME = 508.0618634223938s, BATCH = 32, AVG. THROUGHPUT = 1180.348173291654 samples/s,  AVG. LATENCY = 50.806112098693845
Test Loss: 80408915749109.765625


Test Accuracy (Overall): 8.7600% (876/10000)
Test Loss: 80408915749109.765625


Test Accuracy (Overall): 8.7600% (876/10000)
Rank: 0, ips: 1180.348173291654, 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[3303] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44235', 'RANK': '1', 'WORLD_SIZE': '3'}
[3304] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44235', 'RANK': '2', 'WORLD_SIZE': '3'}
[3302] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '44235', 'RANK': '0', 'WORLD_SIZE': '3'}
[3302] rank = 0, world_size = 3
[3304] rank = 2, world_size = 3
[3303] rank = 1, world_size = 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 372.73333978652954s, BATCH = 32, AVG. THROUGHPUT = 1609.7605210614697 samples/s,  AVG. LATENCY = 37.273253655433656
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 372.73818802833557s, BATCH = 32, AVG. THROUGHPUT = 1609.7386429450414 samples/s,  AVG. LATENCY = 37.273747372627255
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 372.7457449436188s, BATCH = 32, AVG. THROUGHPUT = 1609.7060676763595 samples/s,  AVG. LATENCY = 37.27448682785034
Test Loss: 167250225132050.843750


Test Accuracy (Overall): 25.1600% (2516/10000)
[3304] rank = 2, world_size = 3
Test Loss: 167250225132050.843750


Test Accuracy (Overall): 25.1600% (2516/10000)
[3302] rank = 0, world_size = 3
Test Loss: 167250225132050.843750


Test Accuracy (Overall): 25.1600% (2516/10000)
[3303] rank = 1, world_size = 3
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
RANK = 1, GPU AMOUNT = 3, ELAPSED TIME = 370.79164457321167s, BATCH = 32, AVG. THROUGHPUT = 1618.1787895858427 samples/s,  AVG. LATENCY = 37.079093265533444
RANK = 0, GPU AMOUNT = 3, ELAPSED TIME = 370.83619570732117s, BATCH = 32, AVG. THROUGHPUT = 1617.9842366774583 samples/s,  AVG. LATENCY = 37.08356273174286
RANK = 2, GPU AMOUNT = 3, ELAPSED TIME = 370.805504322052s, BATCH = 32, AVG. THROUGHPUT = 1618.1169074809802 samples/s,  AVG. LATENCY = 37.08048918247223
Test Loss: 130109798785377.890625


Test Accuracy (Overall): 14.5900% (1459/10000)
Rank: 0, ips: 1617.9842366774583, 
Test Loss: 130109798785377.890625


Test Accuracy (Overall): 14.5900% (1459/10000)
Test Loss: 130109798785377.890625


Test Accuracy (Overall): 14.5900% (1459/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[5809] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '58719', 'RANK': '0', 'WORLD_SIZE': '4'}
[5812] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '58719', 'RANK': '3', 'WORLD_SIZE': '4'}
[5810] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '58719', 'RANK': '1', 'WORLD_SIZE': '4'}
[5811] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '58719', 'RANK': '2', 'WORLD_SIZE': '4'}
[5809] rank = 0, world_size = 4
[5811] rank = 2, world_size = 4
[5812] rank = 3, world_size = 4
[5810] rank = 1, world_size = 4
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 3
total trainable parameter amount: 32302090
initializing optimizer and loss  in global rank 1
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 2
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 274.3778736591339s, BATCH = 32, AVG. THROUGHPUT = 2183.3858428517296 samples/s,  AVG. LATENCY = 27.437676858901977
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 274.3810052871704s, BATCH = 32, AVG. THROUGHPUT = 2183.3540720613823 samples/s,  AVG. LATENCY = 27.43800175189972
RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 274.3944571018219s, BATCH = 32, AVG. THROUGHPUT = 2183.2454814252665 samples/s,  AVG. LATENCY = 27.439369630813598
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 274.39505434036255s, BATCH = 32, AVG. THROUGHPUT = 2183.2452643813153 samples/s,  AVG. LATENCY = 27.439383268356323
Test Loss: 102716782597583.671875


Test Accuracy (Overall): 9.3000% (930/10000)
[5811] rank = 2, world_size = 4
Test Loss: 102716782597583.671875


Test Accuracy (Overall): 9.3000% (930/10000)
[5809] rank = 0, world_size = 4
Test Loss: 102716782597583.671875


Test Accuracy (Overall): 9.3000% (930/10000)
[5812] rank = 3, world_size = 4
Test Loss: 102716782597583.671875


Test Accuracy (Overall): 9.3000% (930/10000)
[5810] rank = 1, world_size = 4
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 3initializing optimizer and loss  in global rank 1

RANK = 0, GPU AMOUNT = 4, ELAPSED TIME = 274.56449699401855s, BATCH = 32, AVG. THROUGHPUT = 2181.9173558369107 samples/s,  AVG. LATENCY = 27.456387591362
RANK = 1, GPU AMOUNT = 4, ELAPSED TIME = 274.52392387390137s, BATCH = 32, AVG. THROUGHPUT = 2182.2451246360715 samples/s,  AVG. LATENCY = 27.452319312095643
RANK = 2, GPU AMOUNT = 4, ELAPSED TIME = 274.5264844894409s, BATCH = 32, AVG. THROUGHPUT = 2182.2233400850905 samples/s,  AVG. LATENCY = 27.452586579322816
RANK = 3, GPU AMOUNT = 4, ELAPSED TIME = 274.54517221450806s, BATCH = 32, AVG. THROUGHPUT = 2182.073233696339 samples/s,  AVG. LATENCY = 27.454426288604736
Test Loss: 5482583221724407.000000


Test Accuracy (Overall): 14.0500% (1405/10000)
Test Loss: 5482583221724407.000000


Test Accuracy (Overall): 14.0500% (1405/10000)
Test Loss: 5482583221724407.000000


Test Accuracy (Overall): 14.0500% (1405/10000)
Rank: 0, ips: 2181.9173558369107, 
Test Loss: 5482583221724407.000000


Test Accuracy (Overall): 14.0500% (1405/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[9173] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '40229', 'RANK': '4', 'WORLD_SIZE': '5'}
[9172] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '40229', 'RANK': '3', 'WORLD_SIZE': '5'}
[9170] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '40229', 'RANK': '1', 'WORLD_SIZE': '5'}
[9169] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '40229', 'RANK': '0', 'WORLD_SIZE': '5'}
[9171] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '40229', 'RANK': '2', 'WORLD_SIZE': '5'}
[9169] rank = 0, world_size = 5
[9173] rank = 4, world_size = 5
[9172] rank = 3, world_size = 5
[9171] rank = 2, world_size = 5
[9170] rank = 1, world_size = 5
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 233.6173655986786s, BATCH = 32, AVG. THROUGHPUT = 2568.671830535434 samples/s,  AVG. LATENCY = 23.36161298751831
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 233.61888790130615s, BATCH = 32, AVG. THROUGHPUT = 2568.6701426229483 samples/s,  AVG. LATENCY = 23.361771154403687
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 233.6188063621521s, BATCH = 32, AVG. THROUGHPUT = 2568.657832424356 samples/s,  AVG. LATENCY = 23.361750984191893
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 233.621906042099s, BATCH = 32, AVG. THROUGHPUT = 2568.6135592695855 samples/s,  AVG. LATENCY = 23.362079334259032
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 233.62554502487183s, BATCH = 32, AVG. THROUGHPUT = 2568.560659046031 samples/s,  AVG. LATENCY = 23.362465739250183
Test Loss: 306539058572558.312500


Test Accuracy (Overall): 21.2500% (2125/10000)
[9169] rank = 0, world_size = 5
Test Loss: 306539058572558.312500


Test Accuracy (Overall): 21.2500% (2125/10000)
[9172] rank = 3, world_size = 5
Test Loss: 306539058572558.312500


Test Accuracy (Overall): 21.2500% (2125/10000)
[9173] rank = 4, world_size = 5
Test Loss: 306539058572558.312500


Test Accuracy (Overall): 21.2500% (2125/10000)
[9170] rank = 1, world_size = 5
initializing optimizer and loss  in global rank 0
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
Test Loss: 306539058572558.312500


Test Accuracy (Overall): 21.2500% (2125/10000)
[9171] rank = 2, world_size = 5
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 3
RANK = 0, GPU AMOUNT = 5, ELAPSED TIME = 233.54402232170105s, BATCH = 32, AVG. THROUGHPUT = 2569.6370236994 samples/s,  AVG. LATENCY = 23.354336762428282
RANK = 4, GPU AMOUNT = 5, ELAPSED TIME = 232.97455215454102s, BATCH = 32, AVG. THROUGHPUT = 2575.790132860394 samples/s,  AVG. LATENCY = 23.29736442565918
RANK = 3, GPU AMOUNT = 5, ELAPSED TIME = 232.97833800315857s, BATCH = 32, AVG. THROUGHPUT = 2575.7415926057774 samples/s,  AVG. LATENCY = 23.297762393951416
RANK = 1, GPU AMOUNT = 5, ELAPSED TIME = 233.2715346813202s, BATCH = 32, AVG. THROUGHPUT = 2572.5405862531265 samples/s,  AVG. LATENCY = 23.327077388763428
RANK = 2, GPU AMOUNT = 5, ELAPSED TIME = 232.98038578033447s, BATCH = 32, AVG. THROUGHPUT = 2575.7143039936623 samples/s,  AVG. LATENCY = 23.297986531257628
Test Loss: 359923832661737.500000


Test Accuracy (Overall): 12.9800% (1298/10000)
Test Loss: 359923832661737.500000


Test Accuracy (Overall): 12.9800% (1298/10000)
Test Loss: 359923832661737.500000


Test Accuracy (Overall): 12.9800% (1298/10000)
Test Loss: 359923832661737.500000


Test Accuracy (Overall): 12.9800% (1298/10000)
Rank: 0, ips: 2569.6370236994, 
Test Loss: 359923832661737.500000


Test Accuracy (Overall): 12.9800% (1298/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[13165] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60379', 'RANK': '1', 'WORLD_SIZE': '6'}
[13164] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60379', 'RANK': '0', 'WORLD_SIZE': '6'}
[13168] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60379', 'RANK': '4', 'WORLD_SIZE': '6'}
[13169] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60379', 'RANK': '5', 'WORLD_SIZE': '6'}
[13166] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60379', 'RANK': '2', 'WORLD_SIZE': '6'}
[13167] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '60379', 'RANK': '3', 'WORLD_SIZE': '6'}
[13164] rank = 0, world_size = 6
[13168] rank = 4, world_size = 6
[13166] rank = 2, world_size = 6
[13167] rank = 3, world_size = 6
[13169] rank = 5, world_size = 6
[13165] rank = 1, world_size = 6
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 5initializing optimizer and loss  in global rank 4

total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 196.91281008720398s, BATCH = 32, AVG. THROUGHPUT = 3042.643028788585 samples/s,  AVG. LATENCY = 19.69119441509247RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 196.9126319885254s, BATCH = 32, AVG. THROUGHPUT = 3042.651507852198 samples/s,  AVG. LATENCY = 19.69118688106537

RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 196.91887617111206s, BATCH = 32, AVG. THROUGHPUT = 3042.55818121476 samples/s,  AVG. LATENCY = 19.691789746284485
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 196.92206621170044s, BATCH = 32, AVG. THROUGHPUT = 3042.501263844536 samples/s,  AVG. LATENCY = 19.692104506492615
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 196.92236042022705s, BATCH = 32, AVG. THROUGHPUT = 3042.49284491728 samples/s,  AVG. LATENCY = 19.6921142578125
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 196.92259407043457s, BATCH = 32, AVG. THROUGHPUT = 3042.4925380421005 samples/s,  AVG. LATENCY = 19.692143416404726
Test Loss: 1520590694136991.000000


Test Accuracy (Overall): 21.7400% (2174/10000)
[13165] rank = 1, world_size = 6
Test Loss: 1520590694136991.000000


Test Accuracy (Overall): 21.7400% (2174/10000)
[13164] rank = 0, world_size = 6
Test Loss: 1520590694136991.000000


Test Accuracy (Overall): 21.7400% (2174/10000)
[13168] rank = 4, world_size = 6
Test Loss: 1520590694136991.000000


Test Accuracy (Overall): 21.7400% (2174/10000)
[13167] rank = 3, world_size = 6
Test Loss: 1520590694136991.000000


Test Accuracy (Overall): 21.7400% (2174/10000)
[13169] rank = 5, world_size = 6
Test Loss: 1520590694136991.000000


Test Accuracy (Overall): 21.7400% (2174/10000)
[13166] rank = 2, world_size = 6
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 2initializing optimizer and loss  in global rank 4

initializing optimizer and loss  in global rank 3
RANK = 2, GPU AMOUNT = 6, ELAPSED TIME = 196.49085450172424s, BATCH = 32, AVG. THROUGHPUT = 3048.8698962487283 samples/s,  AVG. LATENCY = 19.649019289016724
RANK = 5, GPU AMOUNT = 6, ELAPSED TIME = 196.49193906784058s, BATCH = 32, AVG. THROUGHPUT = 3048.8563675177256 samples/s,  AVG. LATENCY = 19.64912579059601
RANK = 4, GPU AMOUNT = 6, ELAPSED TIME = 196.49187588691711s, BATCH = 32, AVG. THROUGHPUT = 3048.858995464815 samples/s,  AVG. LATENCY = 19.64913249015808
RANK = 3, GPU AMOUNT = 6, ELAPSED TIME = 196.5003867149353s, BATCH = 32, AVG. THROUGHPUT = 3048.7070125410323 samples/s,  AVG. LATENCY = 19.649977040290832
RANK = 0, GPU AMOUNT = 6, ELAPSED TIME = 196.73262882232666s, BATCH = 32, AVG. THROUGHPUT = 3045.1503397335027 samples/s,  AVG. LATENCY = 19.673188424110414
RANK = 1, GPU AMOUNT = 6, ELAPSED TIME = 196.7346489429474s, BATCH = 32, AVG. THROUGHPUT = 3045.1473418853902 samples/s,  AVG. LATENCY = 19.673380064964295
Test Loss: 578292164315211.375000


Test Accuracy (Overall): 16.4200% (1642/10000)
Rank: 0, ips: 3045.1503397335027, 
Test Loss: 578292164315211.375000


Test Accuracy (Overall): 16.4200% (1642/10000)
Test Loss: 578292164315211.375000


Test Accuracy (Overall): 16.4200% (1642/10000)
Test Loss: 578292164315211.375000


Test Accuracy (Overall): 16.4200% (1642/10000)
Test Loss: 578292164315211.375000


Test Accuracy (Overall): 16.4200% (1642/10000)
Test Loss: 578292164315211.375000


Test Accuracy (Overall): 16.4200% (1642/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[17908] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '5', 'WORLD_SIZE': '7'}
[17903] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '0', 'WORLD_SIZE': '7'}
[17909] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '6', 'WORLD_SIZE': '7'}
[17906] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '3', 'WORLD_SIZE': '7'}
[17904] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '1', 'WORLD_SIZE': '7'}
[17905] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '2', 'WORLD_SIZE': '7'}
[17907] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '55077', 'RANK': '4', 'WORLD_SIZE': '7'}
[17903] rank = 0, world_size = 7
[17908] rank = 5, world_size = 7
[17904] rank = 1, world_size = 7
[17907] rank = 4, world_size = 7
[17909] rank = 6, world_size = 7
[17906] rank = 3, world_size = 7
[17905] rank = 2, world_size = 7
initializing optimizer and loss  in global rank 6
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 1
initializing optimizer and loss  in global rank 2
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 173.16644954681396s, BATCH = 32, AVG. THROUGHPUT = 3454.5074316766877 samples/s,  AVG. LATENCY = 17.316559982299804
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 173.17811346054077s, BATCH = 32, AVG. THROUGHPUT = 3454.2562998021617 samples/s,  AVG. LATENCY = 17.317728090286256
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 173.1784405708313s, BATCH = 32, AVG. THROUGHPUT = 3454.2482091246457 samples/s,  AVG. LATENCY = 17.317741107940673
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 173.17952585220337s, BATCH = 32, AVG. THROUGHPUT = 3454.261629508408 samples/s,  AVG. LATENCY = 17.317877531051636
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 173.18117809295654s, BATCH = 32, AVG. THROUGHPUT = 3454.26776321592 samples/s,  AVG. LATENCY = 17.318013620376586
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 173.20177388191223s, BATCH = 32, AVG. THROUGHPUT = 3453.7833886181193 samples/s,  AVG. LATENCY = 17.320102095603943
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 173.2026982307434s, BATCH = 32, AVG. THROUGHPUT = 3453.8134785452066 samples/s,  AVG. LATENCY = 17.32017252445221
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
[17904] rank = 1, world_size = 7
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
[17907] rank = 4, world_size = 7
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
[17909] rank = 6, world_size = 7
[17905] rank = 2, world_size = 7
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
[17908] rank = 5, world_size = 7
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
[17903] rank = 0, world_size = 7
Test Loss: 482352271000705.437500


Test Accuracy (Overall): 11.6100% (1161/10000)
[17906] rank = 3, world_size = 7
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 0initializing optimizer and loss  in global rank 1

total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 6
RANK = 2, GPU AMOUNT = 7, ELAPSED TIME = 172.5922145843506s, BATCH = 32, AVG. THROUGHPUT = 3465.5554958313064 samples/s,  AVG. LATENCY = 17.259162640571596
RANK = 4, GPU AMOUNT = 7, ELAPSED TIME = 172.58800959587097s, BATCH = 32, AVG. THROUGHPUT = 3465.648624865889 samples/s,  AVG. LATENCY = 17.258734941482544
RANK = 5, GPU AMOUNT = 7, ELAPSED TIME = 172.5879831314087s, BATCH = 32, AVG. THROUGHPUT = 3465.6483714522888 samples/s,  AVG. LATENCY = 17.258726954460144
RANK = 1, GPU AMOUNT = 7, ELAPSED TIME = 172.59424662590027s, BATCH = 32, AVG. THROUGHPUT = 3465.5423469201546 samples/s,  AVG. LATENCY = 17.259352469444273
RANK = 0, GPU AMOUNT = 7, ELAPSED TIME = 172.59976053237915s, BATCH = 32, AVG. THROUGHPUT = 3465.406959095451 samples/s,  AVG. LATENCY = 17.25989434719086
RANK = 6, GPU AMOUNT = 7, ELAPSED TIME = 172.59654831886292s, BATCH = 32, AVG. THROUGHPUT = 3465.475977615178 samples/s,  AVG. LATENCY = 17.259556674957274
RANK = 3, GPU AMOUNT = 7, ELAPSED TIME = 172.60483241081238s, BATCH = 32, AVG. THROUGHPUT = 3465.3104177238565 samples/s,  AVG. LATENCY = 17.26039762496948
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
Rank: 0, ips: 3465.406959095451, 
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
Test Loss: 1203511840106.086426


Test Accuracy (Overall): 10.4300% (1043/10000)
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[23392] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '6', 'WORLD_SIZE': '8'}[23387] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '1', 'WORLD_SIZE': '8'}

[23389] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '3', 'WORLD_SIZE': '8'}
[23386] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '0', 'WORLD_SIZE': '8'}
[23390] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '4', 'WORLD_SIZE': '8'}
[23388] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '2', 'WORLD_SIZE': '8'}
[23393] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '7', 'WORLD_SIZE': '8'}
[23391] Initializing process group with: {'MASTER_ADDR': 'dudu-set-1.pytorch.pelegdav.svc.cluster.local', 'MASTER_PORT': '36155', 'RANK': '5', 'WORLD_SIZE': '8'}
[23386] rank = 0, world_size = 8
[23392] rank = 6, world_size = 8
[23393] rank = 7, world_size = 8
[23389] rank = 3, world_size = 8
[23390] rank = 4, world_size = 8
[23391] rank = 5, world_size = 8
[23388] rank = 2, world_size = 8
[23387] rank = 1, world_size = 8
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 6
total trainable parameter amount: 32302090
initializing optimizer and loss  in global rank 7
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 2
initializing optimizer and loss  in global rank 4
initializing optimizer and loss  in global rank 1initializing optimizer and loss  in global rank 3

RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 152.80584979057312s, BATCH = 32, AVG. THROUGHPUT = 3922.0586212811204 samples/s,  AVG. LATENCY = 15.280459833145141
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 152.81037521362305s, BATCH = 32, AVG. THROUGHPUT = 3921.926313506182 samples/s,  AVG. LATENCY = 15.280949640274049
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 152.80922603607178s, BATCH = 32, AVG. THROUGHPUT = 3921.9555543376177 samples/s,  AVG. LATENCY = 15.280831718444825
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 152.81113934516907s, BATCH = 32, AVG. THROUGHPUT = 3921.954483109067 samples/s,  AVG. LATENCY = 15.281001806259155
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 152.81594038009644s, BATCH = 32, AVG. THROUGHPUT = 3921.824744551621 samples/s,  AVG. LATENCY = 15.28151285648346
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 152.8159728050232s, BATCH = 32, AVG. THROUGHPUT = 3921.805390069288 samples/s,  AVG. LATENCY = 15.281512665748597
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 152.8300952911377s, BATCH = 32, AVG. THROUGHPUT = 3921.402985404436 samples/s,  AVG. LATENCY = 15.28291015625
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 152.83245396614075s, BATCH = 32, AVG. THROUGHPUT = 3921.371177318849 samples/s,  AVG. LATENCY = 15.283112335205079
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23387] rank = 1, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23390] rank = 4, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23389] rank = 3, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23393] rank = 7, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23392] rank = 6, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23391] rank = 5, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23386] rank = 0, world_size = 8
Test Loss: 1507806887618701.000000


Test Accuracy (Overall): 8.7900% (879/10000)
[23388] rank = 2, world_size = 8
initializing optimizer and loss  in global rank 0
initializing optimizer and loss  in global rank 1
total trainable parameter amount: 32302090
model: 
DistributedDataParallel(
  (module): Net(
    (seq): ModuleList(
      (0): Linear(in_features=784, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
      (2): Linear(in_features=1024, out_features=1024, bias=True)
      (3): Linear(in_features=1024, out_features=1024, bias=True)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): Linear(in_features=1024, out_features=1024, bias=True)
      (6): Linear(in_features=1024, out_features=1024, bias=True)
      (7): Linear(in_features=1024, out_features=1024, bias=True)
      (8): Linear(in_features=1024, out_features=1024, bias=True)
      (9): Linear(in_features=1024, out_features=1024, bias=True)
      (10): Linear(in_features=1024, out_features=1024, bias=True)
      (11): Linear(in_features=1024, out_features=1024, bias=True)
      (12): Linear(in_features=1024, out_features=1024, bias=True)
      (13): Linear(in_features=1024, out_features=1024, bias=True)
      (14): Linear(in_features=1024, out_features=1024, bias=True)
      (15): Linear(in_features=1024, out_features=1024, bias=True)
      (16): Linear(in_features=1024, out_features=1024, bias=True)
      (17): Linear(in_features=1024, out_features=1024, bias=True)
      (18): Linear(in_features=1024, out_features=1024, bias=True)
      (19): Linear(in_features=1024, out_features=1024, bias=True)
      (20): Linear(in_features=1024, out_features=1024, bias=True)
      (21): Linear(in_features=1024, out_features=1024, bias=True)
      (22): Linear(in_features=1024, out_features=1024, bias=True)
      (23): Linear(in_features=1024, out_features=1024, bias=True)
      (24): Linear(in_features=1024, out_features=1024, bias=True)
      (25): Linear(in_features=1024, out_features=1024, bias=True)
      (26): Linear(in_features=1024, out_features=1024, bias=True)
      (27): Linear(in_features=1024, out_features=1024, bias=True)
      (28): Linear(in_features=1024, out_features=1024, bias=True)
      (29): Linear(in_features=1024, out_features=1024, bias=True)
      (30): Linear(in_features=1024, out_features=1024, bias=True)
      (31): Linear(in_features=1024, out_features=10, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
  )
)
initializing optimizer and loss  in global rank 5
initializing optimizer and loss  in global rank 7
initializing optimizer and loss  in global rank 6initializing optimizer and loss  in global rank 2

initializing optimizer and loss  in global rank 3
initializing optimizer and loss  in global rank 4
RANK = 6, GPU AMOUNT = 8, ELAPSED TIME = 152.38131523132324s, BATCH = 32, AVG. THROUGHPUT = 3931.4746097587995 samples/s,  AVG. LATENCY = 15.238070082664489
RANK = 7, GPU AMOUNT = 8, ELAPSED TIME = 152.38460111618042s, BATCH = 32, AVG. THROUGHPUT = 3931.3904408913136 samples/s,  AVG. LATENCY = 15.238393902778625
RANK = 3, GPU AMOUNT = 8, ELAPSED TIME = 152.3853316307068s, BATCH = 32, AVG. THROUGHPUT = 3931.3531771995995 samples/s,  AVG. LATENCY = 15.238473486900329
RANK = 4, GPU AMOUNT = 8, ELAPSED TIME = 152.38546633720398s, BATCH = 32, AVG. THROUGHPUT = 3931.3905334335336 samples/s,  AVG. LATENCY = 15.238448929786681
RANK = 5, GPU AMOUNT = 8, ELAPSED TIME = 152.38760209083557s, BATCH = 32, AVG. THROUGHPUT = 3931.3113806600327 samples/s,  AVG. LATENCY = 15.238676643371582
RANK = 1, GPU AMOUNT = 8, ELAPSED TIME = 152.4068636894226s, BATCH = 32, AVG. THROUGHPUT = 3930.829370527851 samples/s,  AVG. LATENCY = 15.240597915649413
RANK = 0, GPU AMOUNT = 8, ELAPSED TIME = 152.4109172821045s, BATCH = 32, AVG. THROUGHPUT = 3930.7054624567354 samples/s,  AVG. LATENCY = 15.241011476516723
RANK = 2, GPU AMOUNT = 8, ELAPSED TIME = 152.3985879421234s, BATCH = 32, AVG. THROUGHPUT = 3931.050345561416 samples/s,  AVG. LATENCY = 15.239763522148133
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Rank: 0, ips: 3930.7054624567354, 
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
Test Loss: 5353558008683037.000000


Test Accuracy (Overall): 20.9200% (2092/10000)
